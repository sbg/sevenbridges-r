<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Complete Guide for Seven Bridges API R Client • sevenbridges-r</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Complete Guide for Seven Bridges API R Client">
<meta property="og:description" content="sevenbridges">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-87185344-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-87185344-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sevenbridges-r</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/api.html">Complete Guide for Seven Bridges API R Client</a>
    </li>
    <li>
      <a href="../articles/apps.html">Describe and Execute CWL Tools/Workflows in R</a>
    </li>
    <li>
      <a href="../articles/bioc-workflow.html">Master Tutorial: Use R for Cancer Genomics Cloud</a>
    </li>
    <li>
      <a href="../articles/cgc-datasets.html">Find Data on CGC via Data Browser and Datasets API</a>
    </li>
    <li>
      <a href="../articles/docker.html">Creating Your Docker Container and Command Line Interface (with docopt)</a>
    </li>
    <li>
      <a href="../articles/rstudio.html">IDE Container: RStudio Server, Shiny Server, and More</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sbg/sevenbridges-r/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="api_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Complete Guide for Seven Bridges API R Client</h1>
            
            <h4 class="date">2020-03-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sbg/sevenbridges-r/blob/master/vignettes/api.Rmd"><code>vignettes/api.Rmd</code></a></small>
      <div class="hidden name"><code>api.Rmd</code></div>

    </div>

    
    
<p><a name="top"></a></p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code>sevenbridges</code> is an R/Bioconductor package that provides an interface for Seven Bridges public API. The supported platforms includes the <a href="https://igor.sbgenomics.com/">Seven Bridges Platform</a>, <a href="https://www.cancergenomicscloud.org">Cancer Genomics Cloud (CGC)</a>, and <a href="https://cavatica.sbgenomics.com">Cavatica</a>.</p>
<p>Learn more from our documentation on the <a href="https://docs.sevenbridges.com/page/api">Seven Bridges Platform</a> and the <a href="http://docs.cancergenomicscloud.org/v1.0/page/the-cgc-api">Cancer Genomics Cloud (CGC)</a>.</p>
<div id="r-client-for-seven-bridges-api" class="section level2">
<h2 class="hasAnchor">
<a href="#r-client-for-seven-bridges-api" class="anchor"></a>R Client for Seven Bridges API</h2>
<p>The <code>sevenbridges</code> package only supports v2+ versions of the API, since versions prior to V2 are not compatible with the Common Workflow Language (CWL). This package provides a simple interface for accessing and trying out various methods.</p>
<p>There are two ways of constructing API calls. For instance, you can use low-level API calls which use arguments like <code>path</code>, <code>query</code>, and <code>body</code>. These are documented in the API reference libraries for the <a href="https://docs.sevenbridges.com/reference#list-all-api-paths">Seven Bridges Platform</a> and the <a href="http://docs.cancergenomicscloud.org/docs/new-1">CGC</a>. An example of a low-level request to “list all projects” is shown below. In this request, you can also pass <code>query</code> and <code>body</code> as a list.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"sevenbridges"</span>)
<span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">token</span> <span class="kw">=</span> <span class="st">"your_token"</span>, <span class="kw">platform</span> <span class="kw">=</span> <span class="st">"aws-us"</span>)
<span class="no">a</span>$<span class="fu"><a href="../reference/api.html">api</a></span>(<span class="kw">path</span> <span class="kw">=</span> <span class="st">"projects"</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"GET"</span>)</pre></body></html></div>
<p><strong><em>(Advanced user option)</em></strong> The second way of constructing an API request is to directly use the <code>httr</code> package to make your API calls, as shown below.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">project</span>()</pre></body></html></div>
</div>
<div id="api-general-information" class="section level2">
<h2 class="hasAnchor">
<a href="#api-general-information" class="anchor"></a>API General Information</h2>
<p>Before we start, keep in mind the following:</p>
<p><strong><code>offset</code> and <code>limit</code></strong></p>
<p>Every API call accepts two arguments named <code>offset</code> and <code>limit</code>.</p>
<ul>
<li>Offset defines where the retrieved items started.</li>
<li>Limit defines the number of items you want to get.</li>
</ul>
<p>By default, <code>offset</code> is set to <code>0</code> and <code>limit</code> is set to <code>100</code>. As such, your API request returns the <strong>first 100 items</strong> when you list items or search for items by name. To search and list all items, use <code>complete = TRUE</code> in your API request.</p>
<p><strong>Search by ID</strong></p>
<p>When searching by ID, your request will return your exact resource as it is unique. As such, you do not have to set <code>offset</code> and <code>limit</code> manually. It is a good practice to find your resources by their ID and pass this ID as an input to your task. You can find a resource’s ID in the final part of the URL on the visual interface or via the API requests to list resources or get a resource’s details.</p>
<p><strong>Search by name</strong></p>
<p>Search by name returns all partial matches unless you specify <code>exact = TRUE</code>.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The <code>sevenbridges</code> package is available on both the <code>release</code> and <code>devel</code> branch from Bioconductor.</p>
<p>To install it from the <code>release</code> branch, use:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)
<span class="kw pkg">BiocManager</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">"sevenbridges"</span>)</pre></body></html></div>
<p>To install it from the <code>devel</code> branch, use:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)
<span class="kw pkg">BiocManager</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">"sevenbridges"</span>, <span class="kw">version</span> <span class="kw">=</span> <span class="st">"devel"</span>)</pre></body></html></div>
<p>Since we are constantly improving our API and client libraries, please also visit our <a href="https://github.com/sbg/sevenbridges-r">GitHub repository</a> for the most recent news and the latest version of the package.</p>
<p><strong>If you do not have <code>devtools</code></strong></p>
<p>This installation requires that you have the <code>devtools</code> package. If you do not have this package, you can install it from CRAN.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)</pre></body></html></div>
<p>You may get an error for missing system dependencies such as <code>curl</code> and <code>openssl</code>. For example, in Ubuntu, you probably need to do the following first to install <code>devtools</code> and to build vignettes since you need <code>pandoc</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a><span class="ex">apt-get</span> update</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="ex">apt-get</span> install libcurl4-gnutls-dev libssl-dev pandoc pandoc-citeproc</span></code></pre></div>
<p><strong>If <code>devtools</code> is already installed</strong></p>
<p>Install the latest version for <code>sevenbridges</code> from GitHub with the following:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"readr"</span>)

<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(
  <span class="st">"sbg/sevenbridges-r"</span>,
  <span class="kw">repos</span> <span class="kw">=</span> <span class="kw pkg">BiocManager</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/repositories.html">repositories</a></span>(),
  <span class="kw">build_vignettes</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">dependencies</span> <span class="kw">=</span> <span class="fl">TRUE</span>
)</pre></body></html></div>
<p>If you have trouble with <code>pandoc</code> and do not want to install it, set <code>build_vignettes = FALSE</code> to avoid the vignettes build.</p>
</div>
</div>
<div id="quickstart" class="section level1">
<h1 class="hasAnchor">
<a href="#quickstart" class="anchor"></a>Quickstart</h1>
<p>For more details about how to use the API client in R, please consult the <a href="#reference">Seven Bridges API Reference</a> section below for a complete guide.</p>
<div id="create-auth-object" class="section level2">
<h2 class="hasAnchor">
<a href="#create-auth-object" class="anchor"></a>Create <code>Auth</code> Object</h2>
<p>Before you can access your account via the API, you have to provide your credentials. You can obtain your credentials in the form of an <a href="https://docs.sevenbridges.com/v1.0/docs/get-your-authentication-token">“authentication token”</a> from the <strong>Developer Tab</strong> under <strong>Account Settings</strong> on the visual interface. Once you’ve obtained this, create an <code>Auth</code> object, so it remembers your authentication token and the path for the API. All subsequent requests will draw upon these two pieces of information.</p>
<p>Let’s load the package first:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"sevenbridges"</span>)</pre></body></html></div>
<p>You have three different ways to provide your token. Choose from one method below:</p>
<ol style="list-style-type: decimal">
<li>
<a href="#method1">Direct authentication.</a> This explicitly and temporarily sets up your token and platform type (or alternatively, API base URL) in the function call arguments to <code><a href="../reference/Auth-class.html">Auth()</a></code>.</li>
<li>
<a href="#method2">Authentication via system environment variables.</a> This will read the credential information from two system environment variables: <code>SB_API_ENDPOINT</code> and <code>SB_AUTH_TOKEN</code>.</li>
<li>
<a href="#method3">Authentication via the user configuration file.</a> This file, by default <code>$HOME/.sevenbridges/credentials</code>, provides an organized way to collect and manage all your API authentication information for Seven Bridges platforms.</li>
</ol>
<div style="margin-left:3em">
<p><a name="method1"></a><strong>Method 1: Direct authentication</strong></p>
<p>This is the most common method to construct the <code>Auth</code> object. For example:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r">(<span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">platform</span> <span class="kw">=</span> <span class="st">"cgc"</span>, <span class="kw">token</span> <span class="kw">=</span> <span class="st">"your_token"</span>))</pre></body></html></div>
<pre><code>Using platform: cgc
== Auth ==
url : https://cgc-api.sbgenomics.com/v2/
token : &lt;your_token&gt;</code></pre>
<p><a name="method2"></a><strong>Method 2: Environment variables</strong></p>
<p>To set the two environment variables in your system, you could use the function <code><a href="../reference/sbg_set_env.html">sbg_set_env()</a></code>. For example:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="../reference/sbg_set_env.html">sbg_set_env</a></span>(<span class="st">"https://cgc-api.sbgenomics.com/v2"</span>, <span class="st">"your_token"</span>)</pre></body></html></div>
<p>Note that this change might be just temporary, please feel free to use the standard method to set persistent environment variables according to your operating system.</p>
<p>Create an <code>Auth</code> object:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="st">"env"</span>)</pre></body></html></div>
<p><a name="method3"></a><strong><em>Method 3: User configuration file</em></strong></p>
<p>Assume we have already created the configuration file named <code>credentials</code> under the directory <code>$HOME/.sevenbridges/</code>:</p>
<pre><code>[aws-us-rfranklin]
api_endpoint = https://api.sbgenomics.com/v2
auth_token = token_for_this_user

# This is a comment:
# another user on the same platform
[aws-us-rosalind-franklin]
api_endpoint = https://api.sbgenomics.com/v2
auth_token = token_for_this_user

[default]
api_endpoint = https://cgc-api.sbgenomics.com/v2
auth_token = token_for_this_user

[gcp]
api_endpoint = https://gcp-api.sbgenomics.com/v2
auth_token = token_for_this_user</code></pre>
<p>To load the user profile <code>aws-us-rfranklin</code> from this configuration file, simply use:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="st">"file"</span>, <span class="kw">profile_name</span> <span class="kw">=</span> <span class="st">"aws-us-rfranklin"</span>)</pre></body></html></div>
<p>If <code>profile_name</code> is not specified, we will try to load the profile named <code>[default]</code>:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="st">"file"</span>)</pre></body></html></div>
<p><strong><em>Note:</em></strong> API paths (base URLs) differ for each Seven Bridges environment. Be sure to provide the correct path for the environment you are using. API paths for some of the environments are:</p>
<table class="table">
<colgroup>
<col width="38%">
<col width="44%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th>Platform Name</th>
<th>API Base URL</th>
<th>Short Name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Seven Bridges Platform (US)</td>
<td><code>https://api.sbgenomics.com/v2</code></td>
<td><code>"aws-us"</code></td>
</tr>
<tr class="even">
<td>Seven Bridges Platform (EU)</td>
<td><code>https://eu-api.sbgenomics.com/v2</code></td>
<td><code>"aws-eu"</code></td>
</tr>
<tr class="odd">
<td>Seven Bridges Platform (China)</td>
<td><code>https://api.sevenbridges.cn/v2</code></td>
<td><code>"ali-cn"</code></td>
</tr>
<tr class="even">
<td>Cancer Genomics Cloud (CGC)</td>
<td><code>https://cgc-api.sbgenomics.com/v2</code></td>
<td><code>"cgc"</code></td>
</tr>
<tr class="odd">
<td>Cavatica</td>
<td><code>https://cavatica-api.sbgenomics.com/v2</code></td>
<td><code>"cavatica"</code></td>
</tr>
<tr class="even">
<td>DataSTAGE Powered by Seven Bridges</td>
<td><code>https://f4c-api.sbgenomics.com/v2</code></td>
<td><code>"f4c"</code></td>
</tr>
</tbody>
</table>
<p>Please refer to the <a href="#auth-reference">API reference section</a> for more usage and technical details about the three authentication methods.</p>
</div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-user-information" class="section level2">
<h2 class="hasAnchor">
<a href="#get-user-information" class="anchor"></a>Get User Information</h2>
<p><a name="youruser"></a><strong>Get your own information</strong></p>
<p>This call returns information about your account.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">user</span>()</pre></body></html></div>
<pre><code>== User ==
href : https://cgc-api.sbgenomics.com/v2/users/RFranklin
username : RFranklin
email : rosalind.franklin@sbgenomics.com
first_name : Rosalind
last_name : Franklin
affiliation : Seven Bridges Genomics
country : United States</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
<p><strong>Get information about a user</strong></p>
<p>This call returns information about the specified user. Note that currently you can view only your own user information, so this call is equivalent to the <a href="#youruser">call to get information about your account</a>.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">user</span>(<span class="kw">username</span> <span class="kw">=</span> <span class="st">"RFranklin"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="rate-limit" class="section level2">
<h2 class="hasAnchor">
<a href="#rate-limit" class="anchor"></a>Rate Limit</h2>
<p>This call returns information about your current rate limit. This is the number of API calls you can make in one hour.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">rate_limit</span>()</pre></body></html></div>
<pre><code>== Rate Limit ==
limit : 1000
remaining : 993
reset : 1457980957</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="show-billing-information" class="section level2">
<h2 class="hasAnchor">
<a href="#show-billing-information" class="anchor"></a>Show Billing Information</h2>
<p>Each project must have a Billing Group associated with it. This Billing Group pays for the storage and computation in the project.</p>
<p>For example, your first project(s) were created with the free funds from the Pilot Funds Billing Group assigned to each user at sign-up. To get information about billing:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="co"># check your billing info</span>
<span class="no">a</span>$<span class="fu">billing</span>()
<span class="no">a</span>$<span class="fu">invoice</span>()</pre></body></html></div>
<p>For more information, use <code>breakdown = TRUE</code>.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">billing</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"your_billing_id"</span>, <span class="kw">breakdown</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-project" class="section level2">
<h2 class="hasAnchor">
<a href="#create-project" class="anchor"></a>Create Project</h2>
<p>Projects are the core building blocks of the platform. Each project corresponds to a distinct scientific investigation, serving as a container for its data, analysis tools, results, and collaborators.</p>
<p>Create a new project called “api testing” with the billing group <code>id</code> obtained above.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="co"># get billing group id</span>
<span class="no">bid</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">billing</span>()$<span class="no">id</span>
<span class="co"># create new project</span>
(<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project_new</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"api testing"</span>, <span class="no">bid</span>, <span class="kw">description</span> <span class="kw">=</span> <span class="st">"Just a test"</span>))</pre></body></html></div>
<pre><code>== Project ==
id : RFranklin/api-testing
name : api testing
description : Just a test
billing_group_id : &lt;your_bid&gt;
type : v2
-- Permission --</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-details-about-existing-project" class="section level2">
<h2 class="hasAnchor">
<a href="#get-details-about-existing-project" class="anchor"></a>Get Details about Existing Project</h2>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="co"># list first 100</span>
<span class="no">a</span>$<span class="fu">project</span>()
<span class="co"># list all</span>
<span class="no">a</span>$<span class="fu">project</span>(<span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># return all named match "demo"</span>
<span class="no">a</span>$<span class="fu">project</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"demo"</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># get the project you want by id</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/api-tutorial"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="copy-public-apps-into-your-project" class="section level2">
<h2 class="hasAnchor">
<a href="#copy-public-apps-into-your-project" class="anchor"></a>Copy Public Apps into Your Project</h2>
<p>Seven Bridges maintains workflows and tools available to all of its users in the Public Apps repository.</p>
<p>To find out more about public apps, you can do the following:</p>
<ul>
<li>Browse them online. Check out the <a href="http://docs.cancergenomicscloud.org/docs/">tutorial</a> for the “Find apps” section.</li>
<li>You can use the <code>sevenbridges</code> package to find it, as shown below.</li>
</ul>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="co"># search by name matching, complete = TRUE search all apps,</span>
<span class="co"># not limited by offset or limit.</span>
<span class="no">a</span>$<span class="fu">public_app</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"STAR"</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># search by id is accurate</span>
<span class="no">a</span>$<span class="fu">public_app</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"admin/sbg-public-data/rna-seq-alignment-star/5"</span>)
<span class="co"># you can also get everything</span>
<span class="no">a</span>$<span class="fu">public_app</span>(<span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># default limit = 100, offset = 0 which means the first 100</span>
<span class="no">a</span>$<span class="fu">public_app</span>()</pre></body></html></div>
<p>Now, from your <code>Auth</code> object, you copy an App <code>id</code> into your <code>project</code> id with a new <code>name</code>, following this logic.</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="co"># copy</span>
<span class="no">a</span>$<span class="fu">copy_app</span>(
  <span class="kw">id</span> <span class="kw">=</span> <span class="st">"admin/sbg-public-data/rna-seq-alignment-star/5"</span>,
  <span class="kw">project</span> <span class="kw">=</span> <span class="st">"RFranklin/api-testing"</span>, <span class="kw">name</span> <span class="kw">=</span> <span class="st">"new copy of star"</span>
)
<span class="co"># check if it is copied</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/api-testing"</span>)
<span class="co"># list apps your got in your project</span>
<span class="no">p</span>$<span class="fu">app</span>()</pre></body></html></div>
<p>The short name is changed to <code>newcopyofstar</code>.</p>
<pre><code>== App ==
id : RFranklin/api-testing/newcopyofstar/0
name : RNA-seq Alignment - STAR
project : RFranklin/api-testing-2
revision : 0</code></pre>
<p>Alternatively, you can copy it from the <code>app</code> object.</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">app</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">public_app</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"admin/sbg-public-data/rna-seq-alignment-star"</span>)
<span class="no">app</span>$<span class="fu">copy_to</span>(
  <span class="kw">project</span> <span class="kw">=</span> <span class="st">"RFranklin/api-testing"</span>,
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"copy of star"</span>
)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="import-cwl-app-and-run-a-task" class="section level2">
<h2 class="hasAnchor">
<a href="#import-cwl-app-and-run-a-task" class="anchor"></a>Import CWL App and Run a Task</h2>
<p>You can also upload your own Common Workflow Language JSON file which describes your app to your project.</p>
<p><strong><em>Note:</em></strong> Alternatively, you can directly describe your CWL tool in R with this package. Please read the vignette on “Describe CWL Tools/Workflows in R and Execution”.</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="co"># add an CWL file to your project</span>
<span class="no">f.star</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/app"</span>, <span class="st">"flow_star.json"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"sevenbridges"</span>)
<span class="no">app</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu">app_add</span>(<span class="st">"starlocal"</span>, <span class="no">fl.runif</span>)
(<span class="no">aid</span> <span class="kw">&lt;-</span> <span class="no">app</span>$<span class="no">id</span>)</pre></body></html></div>
<p>You will get an app <code>id</code>, like the one below:</p>
<pre><code>"RFranklin/api-testing/starlocal/0"</code></pre>
<p>It’s composed of the following elements:</p>
<ol style="list-style-type: decimal">
<li>
<strong>project id</strong> : <code>RFranklin/api</code>
</li>
<li>
<strong>app short name</strong> : <code>runif</code>
</li>
<li>
<strong>revision</strong> : <code>0</code>
</li>
</ol>
<p>Alternatively, you can describe tools in R directly, as shown below:</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="no">fl</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"docker"</span>, <span class="st">"sevenbridges/rabix/generator.R"</span>,
  <span class="kw">package</span> <span class="kw">=</span> <span class="st">"sevenbridges"</span>
)
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span>(<span class="no">fl</span>), <span class="kw">sep</span> <span class="kw">=</span> <span class="st">"\n"</span>)</pre></body></html></div>
<pre><code><a href="https://rdrr.io/pkg/sevenbridges/man">library("sevenbridges")

in.lst &lt;- list(
  input(
    id = "number",
    description = "number of observations",
    type = "integer",
    label = "number",
    prefix = "--n",
    default = 1,
    required = TRUE,
    cmdInclude = TRUE
  ),
  input(
    id = "min",
    description = "lower limits of the distribution",
    type = "float",
    label = "min",
    prefix = "--min",
    default = 0
  ),
  input(
    id = "max",
    description = "upper limits of the distribution",
    type = "float",
    label = "max",
    prefix = "--max",
    default = 1
  ),
  input(
    id = "seed",
    description = "seed with set.seed",
    type = "float",
    label = "seed",
    prefix = "--seed",
    default = 1
  )
)

# the same method for outputs
out.lst &lt;- list(
  output(
    id = "random",
    type = "file",
    label = "output",
    description = "random number file",
    glob = "*.txt"
  ),
  output(
    id = "report",
    type = "file",
    label = "report",
    glob = "*.html"
  )
)

rbx &lt;- Tool(
  id = "runif",
  label = "Random number generator",
  hints = requirements(docker(pull = "tengfei/runif"), cpu(1), mem(2000)),
  baseCommand = "runif.R",
  inputs = in.lst, # or ins.df
  outputs = out.lst
)

fl &lt;- "inst/docker/sevenbridges/rabix/runif.json"
write(rbx$toJSON(pretty = TRUE), fl)</a></code></pre>
<p>Then, you can add it like this:</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="co"># rbx is the object returned by `Tool` function</span>
<span class="no">app</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu">app_add</span>(<span class="st">"runif"</span>, <span class="no">rbx</span>)
(<span class="no">aid</span> <span class="kw">&lt;-</span> <span class="no">app</span>$<span class="no">id</span>)</pre></body></html></div>
<p>Please consult another tutorial <code><a href="../articles/apps.html">vignette("apps", "sevenbridges")</a></code> about how to describe tools and flows in R.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="execute-a-new-task" class="section level2">
<h2 class="hasAnchor">
<a href="#execute-a-new-task" class="anchor"></a>Execute a New Task</h2>
<div id="find-your-app-inputs" class="section level3">
<h3 class="hasAnchor">
<a href="#find-your-app-inputs" class="anchor"></a>Find your app inputs</h3>
<p>Once you have copied the public app <code>admin/sbg-public-data/rna-seq-alignment-star/5</code> into your project, <code>username/api-testing</code>, the app <code>id</code> in your current project is <code>username/api-testing/newcopyofstar</code>. Conversely, you can use another app you already have in your project for this Quickstart.</p>
<p>To draft a new task, you need to specify the following:</p>
<ul>
<li>The name of the task</li>
<li>An optional description</li>
<li>The app <code>id</code> of the workflow you are executing</li>
<li>The inputs for your workflow. In this case, the CWL app accepts four parameters: number, min, max, and seed.</li>
</ul>
<p>You can always check the App details on the visual interface for task input requirements. To find the required inputs with R, you need to get an <code>App</code> object first.</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="no">app</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">app</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/api-testing-2/newcopyofstar"</span>)
<span class="co"># get input matrix</span>
<span class="no">app</span>$<span class="fu"><a href="../reference/input_output_matrix.html">input_matrix</a></span>()
<span class="no">app</span>$<span class="fu"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"label"</span>, <span class="st">"type"</span>))
<span class="co"># get required node only</span>
<span class="no">app</span>$<span class="fu"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"label"</span>, <span class="st">"type"</span>), <span class="kw">required</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>Conversely, you can load the app from a CWL JSON and convert it into an R object first, as shown below.</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">f1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/app"</span>, <span class="st">"flow_star.json"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"sevenbridges"</span>)
<span class="no">app</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/convert_app.html">convert_app</a></span>(<span class="no">f1</span>)
<span class="co"># get input matrix</span>
<span class="no">app</span>$<span class="fu"><a href="../reference/input_output_matrix.html">input_matrix</a></span>()</pre></body></html></div>
<pre><code>##                                id                    label    type required
## 1                    #sjdbGTFfile              sjdbGTFfile File...    FALSE
## 2                          #fastq                    fastq File...     TRUE
## 3               #genomeFastaFiles         genomeFastaFiles    File     TRUE
## 4 #sjdbGTFtagExonParentTranscript      Exons' parents name  string    FALSE
## 5       #sjdbGTFtagExonParentGene                Gene name  string    FALSE
## 6          #winAnchorMultimapNmax         Max loci anchors     int    FALSE
## 7             #winAnchorDistNbins Max bins between anchors     int    FALSE
##   fileTypes
## 1      null
## 2      null
## 3      null
## 4      null
## 5      null
## 6      null
## 7      null</code></pre>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">app</span>$<span class="fu"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"label"</span>, <span class="st">"type"</span>))</pre></body></html></div>
<pre><code>##                                id                    label    type
## 1                    #sjdbGTFfile              sjdbGTFfile File...
## 2                          #fastq                    fastq File...
## 3               #genomeFastaFiles         genomeFastaFiles    File
## 4 #sjdbGTFtagExonParentTranscript      Exons' parents name  string
## 5       #sjdbGTFtagExonParentGene                Gene name  string
## 6          #winAnchorMultimapNmax         Max loci anchors     int
## 7             #winAnchorDistNbins Max bins between anchors     int</code></pre>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="no">app</span>$<span class="fu"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"label"</span>, <span class="st">"type"</span>), <span class="kw">required</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<pre><code>##                  id            label    type
## 2            #fastq            fastq File...
## 3 #genomeFastaFiles genomeFastaFiles    File</code></pre>
<p>Note that <code>input_matrix</code> and <code>output_matrix</code> are useful accessors for <code>Tool</code>, <code>Flow</code>, you can call these two function on a JSON file directly as well.</p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="no">tool.in</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/app"</span>, <span class="st">"tool_unpack_fastq.json"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"sevenbridges"</span>)
<span class="no">flow.in</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/app"</span>, <span class="st">"flow_star.json"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"sevenbridges"</span>)
<span class="fu"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(<span class="no">tool.in</span>)
<span class="fu"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(<span class="no">tool.in</span>, <span class="kw">required</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(<span class="no">flow.in</span>)
<span class="fu"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(<span class="no">flow.in</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"type"</span>))
<span class="fu"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(<span class="no">flow.in</span>, <span class="kw">required</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="../reference/input_output_matrix.html">output_matrix</a></span>(<span class="no">tool.in</span>)
<span class="fu"><a href="../reference/input_output_matrix.html">output_matrix</a></span>(<span class="no">flow.in</span>)</pre></body></html></div>
<p>In the response body, locate the names of the required inputs. Note that task inputs need to match the expected data type and name. In the above example, we see two required fields:</p>
<ul>
<li>
<strong>fastq:</strong> This input takes a file array as indicated by “File…”</li>
<li>
<strong>genomeFastaFiles:</strong> This is a single file as indicated by “File”.</li>
</ul>
<p>We also want to provide a gene feature file:</p>
<ul>
<li>
<strong>sjdbGTFfile:</strong> A single file as indicated by “File”.</li>
</ul>
<p>You can find a list of possible input types below:</p>
<ul>
<li>
<strong>number, character or integer:</strong> you can directly pass these to the input parameter as it is.</li>
<li>
<strong>enum type:</strong> Pass this value to the input parameter.</li>
<li>
<strong>file:</strong> This input is a file. However, while some inputs accept only single file (<code>File</code>), other inputs take more than one file (<code>File</code> arrays, <code>FilesList</code>, or ‘<code>File...</code>’ ). This input requires you to pass a <code>Files</code> object (for a single file input) or <code>FilesList</code> object (for inputs which accept more than one file) or simply a list in a “Files” object. You can search for your file by <code>id</code> or by <code>name</code> with an exact match (<code>exact = TRUE</code>), as shown in the example below.</li>
</ul>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-your-input-files-ready" class="section level3">
<h3 class="hasAnchor">
<a href="#get-your-input-files-ready" class="anchor"></a>Get your input files ready</h3>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="no">fastqs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SRR1039508_1.fastq"</span>, <span class="st">"SRR1039508_2.fastq"</span>)

<span class="co"># get all 2 exact files</span>
<span class="no">fastq_in</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="no">fastqs</span>, <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># get a single file</span>
<span class="no">fasta_in</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Homo_sapiens.GRCh38.dna.primary_assembly.fa"</span>,
  <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>
)
<span class="co"># get all single file</span>
<span class="no">gtf_in</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Homo_sapiens.GRCh38.84.gtf"</span>,
  <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>
)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-new-draft-task" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-new-draft-task" class="anchor"></a>Create a new draft task</h3>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="co"># add new tasks</span>
<span class="no">taskName</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"RFranklin-star-alignment "</span>, <span class="fu"><a href="https://rdrr.io/r/base/date.html">date</a></span>())

<span class="no">tsk</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu">task_add</span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="no">taskName</span>,
  <span class="kw">description</span> <span class="kw">=</span> <span class="st">"star test"</span>,
  <span class="kw">app</span> <span class="kw">=</span> <span class="st">"RFranklin/api-testing-2/newcopyofstar/0"</span>,
  <span class="kw">inputs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">sjdbGTFfile</span> <span class="kw">=</span> <span class="no">gtf_in</span>,
    <span class="kw">fastq</span> <span class="kw">=</span> <span class="no">fastq_in</span>,
    <span class="kw">genomeFastaFiles</span> <span class="kw">=</span> <span class="no">fasta_in</span>
  )
)</pre></body></html></div>
<p>Remember the <code>fastq</code> input expects a list of files. You can also do something as follows:</p>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="no">f1</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"SRR1039508_1.fastq"</span>, <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">f2</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"SRR1039508_2.fastq"</span>, <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># get all 2 exact files</span>
<span class="no">fastq_in</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">f1</span>, <span class="no">f2</span>)

<span class="co"># or if you know you only have 2 files whose names match SRR924146*.fastq</span>
<span class="no">fastq_in</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"SRR1039508*.fastq"</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>Use <code>complete = TRUE</code> when the number of items is over 100.</p>
</div>
<div id="draft-a-batch-task" class="section level3">
<h3 class="hasAnchor">
<a href="#draft-a-batch-task" class="anchor"></a>Draft a batch task</h3>
<p>Now let’s do a batch with 8 files in 4 groups, which is batched by metadata <code>sample_id</code> and <code>library_id</code>. We will assume each file has these two metadata fields entered. Since these files can be evenly grouped into 4, we will have a single parent batch task with 4 child tasks.</p>
<div class="sourceCode" id="cb46"><html><body><pre class="r"><span class="no">fastqs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
  <span class="st">"SRR1039508_1.fastq"</span>, <span class="st">"SRR1039508_2.fastq"</span>, <span class="st">"SRR1039509_1.fastq"</span>,
  <span class="st">"SRR1039509_2.fastq"</span>, <span class="st">"SRR1039512_1.fastq"</span>, <span class="st">"SRR1039512_2.fastq"</span>,
  <span class="st">"SRR1039513_1.fastq"</span>, <span class="st">"SRR1039513_2.fastq"</span>
)

<span class="co"># get all 8 files</span>
<span class="no">fastq_in</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="no">fastqs</span>, <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># can also try to returned all SRR*.fastq files</span>
<span class="co"># fastq_in &lt;- p$file(name= "SRR*.fastq", complete = TRUE)</span>

<span class="no">tsk</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu">task_add</span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="no">taskName</span>,
  <span class="kw">description</span> <span class="kw">=</span> <span class="st">"Batch Star Test"</span>,
  <span class="kw">app</span> <span class="kw">=</span> <span class="st">"RFranklin/api-testing-2/newcopyofstar/0"</span>,
  <span class="kw">batch</span> <span class="kw">=</span> <span class="fu"><a href="../reference/batch.html">batch</a></span>(
    <span class="kw">input</span> <span class="kw">=</span> <span class="st">"fastq"</span>,
    <span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"metadata.sample_id"</span>, <span class="st">"metadata.noexist_id"</span>)
  ),
  <span class="kw">inputs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">sjdbGTFfile</span> <span class="kw">=</span> <span class="no">gtf_in</span>,
    <span class="kw">fastq</span> <span class="kw">=</span> <span class="no">fastqs_in</span>,
    <span class="kw">genomeFastaFiles</span> <span class="kw">=</span> <span class="no">fasta_in</span>
  )
)</pre></body></html></div>
<p>Now you have a draft batch task. Please check it out in the visual interface. Your response body should inform you of any errors or warnings.</p>
<p>Note: you can also directly pass file id or file names as characters to inputs list, the package will first guess if the passed strings are file id (24-bit hexadecimal) or names, then convert it to Files or FilesList object. However, as a good practice, we recommend you construct your files object(e.g. <code>p$file(id = ..., name = ...)</code>) first, check the value, then pass it to <code>task_add</code> inputs. This is a safer approach.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="run-a-task" class="section level2">
<h2 class="hasAnchor">
<a href="#run-a-task" class="anchor"></a>Run a Task</h2>
<p>Now, we are ready to run our task.</p>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="co"># run your task</span>
<span class="no">tsk</span>$<span class="fu">run</span>()</pre></body></html></div>
<p>Before you run your task, you can adjust your draft task if you have any final modifications. Alternatively, you can delete the draft task if you no longer wish to run it.</p>
<div class="sourceCode" id="cb48"><html><body><pre class="r"># # not run
# tsk$delete()</pre></body></html></div>
<p>After you run a task, you can abort it.</p>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="co"># abort your task</span>
<span class="no">tsk</span>$<span class="fu">abort</span>()</pre></body></html></div>
<p>If you want to update your task and then re-run it, follow the example below.</p>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="no">tsk</span>$<span class="fu">getInputs</span>()
<span class="co"># missing number input, only update number</span>
<span class="no">tsk</span>$<span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(<span class="kw">inputs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">sjdbGTFfile</span> <span class="kw">=</span> <span class="st">"some new file"</span>))
<span class="co"># double check</span>
<span class="no">tsk</span>$<span class="fu">getInputs</span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="run-tasks-using-spot-instances" class="section level2">
<h2 class="hasAnchor">
<a href="#run-tasks-using-spot-instances" class="anchor"></a>Run tasks using spot instances</h2>
<p>Running tasks with <a href="https://docs.sevenbridges.com/docs/about-spot-instances">spot instances</a> could potentially <a href="https://www.sevenbridges.com/spot-instances-cost-reduction/">reduce a considerable amount of computational cost</a>. This option can be controlled on the project level or the task level on Seven Bridges platforms. Our package follows the same <a href="https://docs.sevenbridges.com/docs/use-spot-instances">logic</a> as our platform’s web interface (the current default setting for spot instances is <strong>on</strong>).</p>
<p>For example, when we create a project using <code>project_new()</code>, we can set <code>use_interruptible = FALSE</code> to use on-demand instances (non-interruptible but more expensive) instead of the spot instances (interruptible but cheaper):</p>
<div class="sourceCode" id="cb51"><html><body><pre class="r"><span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project_new</span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"spot-disabled-project"</span>, <span class="no">bid</span>, <span class="kw">description</span> <span class="kw">=</span> <span class="st">"spot disabled project"</span>,
  <span class="kw">use_interruptible</span> <span class="kw">=</span> <span class="fl">FALSE</span>
)</pre></body></html></div>
<p>Then all the new tasks created under this project will use on-demand instances to run <strong>by default</strong>, unless an argument <code>use_interruptible_instances</code> is specifically set to <code>TRUE</code> when drafting the new task using <code>task_add()</code>.</p>
<p>For example, if <code>p</code> is the above spot disabled project, to draft a task that will use spot instances to run:</p>
<div class="sourceCode" id="cb52"><html><body><pre class="r"><span class="no">tsk</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu">task_add</span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"spot enabled task in a spot disabled project"</span>),
  <span class="kw">description</span> <span class="kw">=</span> <span class="st">"spot enabled task"</span>,
  <span class="kw">app</span> <span class="kw">=</span> <span class="no">...</span>,
  <span class="kw">inputs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">...</span>),
  <span class="kw">use_interruptible_instances</span> <span class="kw">=</span> <span class="fl">TRUE</span>
)</pre></body></html></div>
<p>Conversely, you can have a spot instance enabled project, but draft and run specific tasks using on-demand instances, by setting <code>use_interruptible_instances = FALSE</code> in <code>task_add()</code> explicitly.</p>
</div>
<div id="execution-hints-per-task-run" class="section level2">
<h2 class="hasAnchor">
<a href="#execution-hints-per-task-run" class="anchor"></a>Execution hints per task run</h2>
<p>During workflow development and benchmarking, sometimes we need to view and make adjustments to the computational resources needed for a task to run more efficiently. Also, if a task fails due to resource deficiency, we often want to define a larger instance for the task re-run without editing the app itself. This is particularly important in cases where there is not enough disk space.</p>
<p>The Seven Bridges API allows setting specific task execution parameters by using <code>execution_settings</code>. It includes the instance type (<code>instance_type</code>) and the maximum number of parallel instances (<code>max_parallel_instances</code>):</p>
<div class="sourceCode" id="cb53"><html><body><pre class="r"><span class="no">tsk</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu">task_add</span>(
  <span class="no">...</span>,
  <span class="kw">execution_settings</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">instance_type</span> <span class="kw">=</span> <span class="st">"c4.2xlarge;ebs-gp2;2000"</span>,
    <span class="kw">max_parallel_instances</span> <span class="kw">=</span> <span class="fl">2</span>
  )
)</pre></body></html></div>
<p>For details about <code>execution_settings</code>, please check <a href="https://docs.sevenbridges.com/v1.0/reference#create-a-new-task">create a new draft task</a>.</p>
</div>
<div id="task-monitoring" class="section level2">
<h2 class="hasAnchor">
<a href="#task-monitoring" class="anchor"></a>Task Monitoring</h2>
<p>To monitor your task as it runs, you can always request a task <code>update</code> to ask your task to report its status. Or, you can monitor a running task with a hook function, which triggers the function when that status is “completed”. Please check the details in <a href="#hooktask">section</a> below.</p>
<div class="sourceCode" id="cb54"><html><body><pre class="r"><span class="no">tsk</span>$<span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>()</pre></body></html></div>
<p>By default, your task alerts you by email when it has been completed.</p>
<div class="sourceCode" id="cb55"><html><body><pre class="r"># Monitor your task (skip this part)
# tsk$monitor()</pre></body></html></div>
<p>Use the following to download all files from a completed task.</p>
<div class="sourceCode" id="cb56"><html><body><pre class="r"><span class="no">tsk</span>$<span class="fu"><a href="../reference/download-methods.html">download</a></span>(<span class="st">"~/Downloads"</span>)</pre></body></html></div>
<p><a name="hooktask"></a>Instead of the default task monitor action, you can use <code>setTaskHook</code> to connect a function call to the status of a task. When you run <code>tsk$monitor(time = 30)</code> it will check your task every 30 seconds to see if the current task status matches one of the following statuses: “queued”, “draft”, “running”, “completed”, “aborted”, and “failed”. When it finds a match for the task status, <code>getTaskHook</code> returns the function call for the specific status.</p>
<div class="sourceCode" id="cb57"><html><body><pre class="r"><span class="fu"><a href="../reference/TaskHook.html">getTaskHook</a></span>(<span class="st">"completed"</span>)</pre></body></html></div>
<pre><code>## function (...) 
## {
##     cat("\r", "completed")
##     return(TRUE)
## }
## &lt;environment: 0x7f85dfc6af08&gt;</code></pre>
<p>If you want to customize the monitor function, you can adjust the following requirement. Your function must return <code>TRUE</code> or <code>FALSE</code> in the end. When it is <code>TRUE</code> (or non-logical value) it means the monitoring will be terminated after it finds a status matched and the function executes, such as when the task is completed. When it is <code>FALSE</code>, it means the monitoring will continue for the next iteration of checking, e.g., when it is “running”, you want to keep tracking.</p>
<p>Follow the example below to set a new function to monitor the status “completed”. Then, when the task is completed, it will download all task output files to the local folder.</p>
<div class="sourceCode" id="cb59"><html><body><pre class="r"><span class="fu"><a href="../reference/TaskHook.html">setTaskHook</a></span>(<span class="st">"completed"</span>, <span class="kw">function</span>() {
  <span class="no">tsk</span>$<span class="fu"><a href="../reference/download-methods.html">download</a></span>(<span class="st">"~/Downloads"</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fl">TRUE</span>)
})
<span class="no">tsk</span>$<span class="fu">monitor</span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
<p><a name="reference"></a></p>
</div>
</div>
<div id="seven-bridges-api-reference" class="section level1">
<h1 class="hasAnchor">
<a href="#seven-bridges-api-reference" class="anchor"></a>Seven Bridges API Reference</h1>
<p>The <code>sevenbridges</code> package provides a user-friendly interface, so you do not have to combine several <code><a href="../reference/api.html">api()</a></code> calls and constantly reference the API documentation to issue API requests.</p>
<div align="right">
<a href="#top">top</a>
</div>
<p><a name="auth-reference"></a></p>
<div id="authentication" class="section level2">
<h2 class="hasAnchor">
<a href="#authentication" class="anchor"></a>Authentication</h2>
<p>Before you can interact with the API, you need to construct an <code>Auth</code> object which stores the following information:</p>
<ul>
<li>Your authentication token. This is used to authenticate your credentials with the API. Learn more about obtaining your authentication token on the <a href="https://docs.sevenbridges.com/v1.0/docs/get-your-authentication-token">Seven Bridges Platform</a> and the <a href="http://docs.cancergenomicscloud.org/v1.0/docs/get-your-authentication-token">Cancer Genomics Cloud</a>. The approach for obtaining the authentication token also applies to the other Seven Bridges platforms.</li>
<li>The path for the API (base URL).</li>
<li>The platform name you are using. This is an optional field, as the base URL of the API ultimately decides where the API calls will be sent to. This field will only be blank when the URL was directly provided, and the platform name could not be inferred from that URL.</li>
</ul>
<p>The general authentication logic for <code><a href="../reference/Auth-class.html">Auth()</a></code> is as follows:</p>
<ol style="list-style-type: decimal">
<li>The package will use the direct authentication method if <code>from</code> is not specified explicitly or specified as <code>from = "direct"</code>.</li>
<li>The package will load the authentication information from environment variables when <code>from = "env"</code>, or user configuration file when <code>from = "file"</code>.</li>
</ol>
<div id="direct-authentication" class="section level3">
<h3 class="hasAnchor">
<a href="#direct-authentication" class="anchor"></a>Direct authentication</h3>
<p>To use direct authentication, users need to specify one of <code>platform</code> or <code>url</code>, with the corresponding <code>token</code>. Examples of direct authentication:</p>
<div class="sourceCode" id="cb60"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(
  <span class="kw">token</span> <span class="kw">=</span> <span class="st">"your_token"</span>,
  <span class="kw">platform</span> <span class="kw">=</span> <span class="st">"aws-us"</span>
)</pre></body></html></div>
<p>The above will use the Seven Bridges Platform on AWS (US).</p>
<div class="sourceCode" id="cb61"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(
  <span class="kw">token</span> <span class="kw">=</span> <span class="st">"your_token"</span>,
  <span class="kw">url</span> <span class="kw">=</span> <span class="st">"https://gcp-api.sbgenomics.com/v2"</span>
)</pre></body></html></div>
<p>The above will use the specified <code>url</code> as the base URL for the API calls. In this example, the <code>url</code> points to the Seven Bridges Platform on Google Cloud Platform (GCP).</p>
<div class="sourceCode" id="cb62"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">token</span> <span class="kw">=</span> <span class="st">"your_token"</span>)</pre></body></html></div>
<p>The above will use the Cancer Genomics Cloud environment since no <code>platform</code> nor <code>url</code> were explicitly specified (not recommended).</p>
<p><strong><em>Note:</em></strong> <code>platform</code> and <code>url</code> should not be specified at the same time.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="authentication-via-system-environment-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#authentication-via-system-environment-variables" class="anchor"></a>Authentication via system environment variables</h3>
<p>The R API client supports reading authentication information stored in system environment variables.</p>
<p>To set the two environment variables in your system, you could use the function <code><a href="../reference/sbg_set_env.html">sbg_set_env()</a></code>. For example:</p>
<div class="sourceCode" id="cb63"><html><body><pre class="r"><span class="fu"><a href="../reference/sbg_set_env.html">sbg_set_env</a></span>(
  <span class="kw">url</span> <span class="kw">=</span> <span class="st">"https://cgc-api.sbgenomics.com/v2"</span>,
  <span class="kw">token</span> <span class="kw">=</span> <span class="st">"your_token"</span>
)</pre></body></html></div>
<p>See if the environment variables are correctly set:</p>
<div class="sourceCode" id="cb64"><html><body><pre class="r"><span class="fu"><a href="../reference/sbg_get_env.html">sbg_get_env</a></span>(<span class="st">"SB_API_ENDPOINT"</span>)
<span class="co">## "https://cgc-api.sbgenomics.com/v2"</span>
<span class="fu"><a href="../reference/sbg_get_env.html">sbg_get_env</a></span>(<span class="st">"SB_AUTH_TOKEN"</span>)
<span class="co">## "your_token"</span></pre></body></html></div>
<p>To create an <code>Auth</code> object:</p>
<div class="sourceCode" id="cb65"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="st">"env"</span>)</pre></body></html></div>
<p>To unset the two environment variables:</p>
<div class="sourceCode" id="cb66"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.unsetenv</a></span>(<span class="st">"SB_API_ENDPOINT"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.unsetenv</a></span>(<span class="st">"SB_AUTH_TOKEN"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="authentication-via-user-configuration-file" class="section level3">
<h3 class="hasAnchor">
<a href="#authentication-via-user-configuration-file" class="anchor"></a>Authentication via user configuration file</h3>
<p>You can create an ini-like file named <code>credentials</code> under the folder <code>$HOME/.sevenbridges/</code> and maintain your credentials for multiple accounts across various Seven Bridges environments. An example:</p>
<pre><code>[aws-us-rfranklin]
api_endpoint = https://api.sbgenomics.com/v2
auth_token = token_for_this_user

# This is a comment:
# another user on the same platform
[aws-us-rosalind-franklin]
api_endpoint = https://api.sbgenomics.com/v2
auth_token = token_for_this_user

[default]
api_endpoint = https://cgc-api.sbgenomics.com/v2
auth_token = token_for_this_user

[gcp]
api_endpoint = https://gcp-api.sbgenomics.com/v2
auth_token = token_for_this_user</code></pre>
<p>Please make sure to have two fields <strong>exactly</strong> named as <code>api_endpoint</code> and <code>auth_token</code> under each profile.</p>
<p>To load the default profile (named <code>[default]</code>) from the default user configuration file (<code>$HOME/.sevenbridges/credentials</code>), please use:</p>
<div class="sourceCode" id="cb68"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="st">"file"</span>)</pre></body></html></div>
<p>To load the user profile <code>aws-us-rfranklin</code> from this configuration file, change the <code>profile_name</code>:</p>
<div class="sourceCode" id="cb69"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="st">"file"</span>, <span class="kw">profile_name</span> <span class="kw">=</span> <span class="st">"aws-us-rfranklin"</span>)</pre></body></html></div>
<p>To use a user configuration file from other locations (not recommended), please specify the file path using the argument <code>config_file</code>. For example:</p>
<div class="sourceCode" id="cb70"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(
  <span class="kw">from</span> <span class="kw">=</span> <span class="st">"file"</span>, <span class="kw">config_file</span> <span class="kw">=</span> <span class="st">"~/sevenbridges.cfg"</span>,
  <span class="kw">profile_name</span> <span class="kw">=</span> <span class="st">"aws-us-rfranklin"</span>
)</pre></body></html></div>
<p><strong><em>Note:</em></strong> If you edited the <code>credentials</code> file, please use <code><a href="../reference/Auth-class.html">Auth()</a></code> to re-authenticate.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="list-all-api-calls" class="section level2">
<h2 class="hasAnchor">
<a href="#list-all-api-calls" class="anchor"></a>List All API Calls</h2>
<p>If you did not pass any parameters to <code><a href="../reference/api.html">api()</a></code> from <code>Auth</code>, it would list all API calls. Any parameters you provide will be passed to the <code><a href="../reference/api.html">api()</a></code> function, but you do not have to pass your input token and path once more since the <code>Auth</code> object already has this information. The following call from the <code>Auth</code> object will check the response as well.</p>
<div class="sourceCode" id="cb71"><html><body><pre class="r"><span class="no">a</span>$<span class="fu"><a href="../reference/api.html">api</a></span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="offset-limit-search-and-advance-access-features" class="section level2">
<h2 class="hasAnchor">
<a href="#offset-limit-search-and-advance-access-features" class="anchor"></a>Offset, Limit, Search, and Advance Access Features</h2>
<div id="offset-and-limit" class="section level3">
<h3 class="hasAnchor">
<a href="#offset-and-limit" class="anchor"></a><code>offset</code> and <code>limit</code>
</h3>
<p>Every API call accepts two arguments named <code>offset</code> and <code>limit</code>.</p>
<ul>
<li>
<code>offset</code> defines where the retrieved items started.</li>
<li>
<code>limit</code> defines the number of items you want to get.</li>
</ul>
<p>By default, <code>offset</code> is set to <code>0</code> and <code>limit</code> is set to <code>50</code>. As such, your API request returns the <strong>first 100 items</strong> when you list items or search for items by name. To search and list all items, use <code>complete = TRUE</code> in your API request.</p>
<div class="sourceCode" id="cb72"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"sevenbridges"</span>)$<span class="no">offset</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"sevenbridges"</span>)$<span class="no">limit</span></pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-id" class="section level3">
<h3 class="hasAnchor">
<a href="#search-by-id" class="anchor"></a>Search by ID</h3>
<p>When searching by ID, your request will return your exact resource as it is unique. As such, you do not have to set <code>offset</code> and <code>limit</code> manually. It is a good practice to find your resources by their ID and pass this ID as an input to your task. You can find a resource’s ID in the final part of the URL on the visual interface or via the API requests to list resources or get a resource’s details.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-name" class="section level3">
<h3 class="hasAnchor">
<a href="#search-by-name" class="anchor"></a>Search by name</h3>
<p>Search by name returns all partial matches unless you specify <code>exact = TRUE</code>. This type of search will only search across current pulled content, so use <code>complete = TRUE</code> if you want to search across everything.</p>
<p>For example, to list all public apps, use <code>visibility</code> argument, but make sure you pass <code>complete = TRUE</code> to it, to show everything. This arguments generally works for items like “App”, “Project”, “Task”, “File”, etc.</p>
<div class="sourceCode" id="cb73"><html><body><pre class="r"><span class="co"># first, search by id is fast</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">app</span>(<span class="kw">visibility</span> <span class="kw">=</span> <span class="st">"public"</span>, <span class="kw">id</span> <span class="kw">=</span> <span class="st">"admin/sbg-public-data/sbg-ucsc-b37-bed-converter/1"</span>)

<span class="co"># show 100 items from public</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">app</span>(<span class="kw">visibility</span> <span class="kw">=</span> <span class="st">"public"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>) <span class="co"># 100</span>

<span class="no">x</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">app</span>(<span class="kw">visibility</span> <span class="kw">=</span> <span class="st">"public"</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>) <span class="co"># 272 by Nov 2016</span>
<span class="co"># this return nothing, because it is not in the first 100 returned names</span>
<span class="no">a</span>$<span class="fu">app</span>(<span class="kw">visibility</span> <span class="kw">=</span> <span class="st">"public"</span>, <span class="kw">name</span> <span class="kw">=</span> <span class="st">"bed converter"</span>)
<span class="co"># this return an app, because it pulls *all* app names and did search</span>
<span class="no">a</span>$<span class="fu">app</span>(<span class="kw">visibility</span> <span class="kw">=</span> <span class="st">"public"</span>, <span class="kw">name</span> <span class="kw">=</span> <span class="st">"bed converter"</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="experiment-with-advance-access-features" class="section level3">
<h3 class="hasAnchor">
<a href="#experiment-with-advance-access-features" class="anchor"></a>Experiment with Advance Access features</h3>
<p>Similar to <code>offset</code> and <code>limit</code>, every API call accepts an argument named <code>advance_access</code>. This argument was first introduced in August 2017 and controls if a special field in the HTTP request header will be sent, which can enable the access to the “Advance Access” features in the Seven Bridges API. Note that the Advance Access features in the API are <strong>not officially released yet</strong>, therefore the API usages are subject to change, so please use with discretion.</p>
<p>In addition to modifying each API call that uses Advance Access features, the option can also be set globally at the beginning of your API script. This offers a one-button switch for users who want to experiment with the Advance Access features. The option is disabled by default:</p>
<div class="sourceCode" id="cb74"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"sevenbridges"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"sevenbridges"</span>)$<span class="no">advance_access</span></pre></body></html></div>
<pre><code>## [1] FALSE</code></pre>
<p>For example, the Markers API is in Advance Access as of November 2018. If we try to use the Markers API to list markers available on a BAM file with the <code>advance_access</code> option disabled, it will return an error message:</p>
<div class="sourceCode" id="cb76"><html><body><pre class="r"><span class="no">req</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/api.html">api</a></span>(
  <span class="kw">token</span> <span class="kw">=</span> <span class="st">"your_token"</span>, <span class="kw">path</span> <span class="kw">=</span> <span class="st">"genome/markers?file={bam_file_id}"</span>,
  <span class="kw">method</span> <span class="kw">=</span> <span class="st">"GET"</span>
)

<span class="kw pkg">httr</span><span class="kw ns">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/content.html">content</a></span>(<span class="no">req</span>)$<span class="st">"message"</span></pre></body></html></div>
<pre><code>## [1] "Advance access feature needs X-SBG-Advance-Access: advance header."</code></pre>
<p>To enable the Advance Access features, one can use</p>
<div class="sourceCode" id="cb78"><html><body><pre class="r"><span class="no">opt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"sevenbridges"</span>)
<span class="no">opt</span>$<span class="no">advance_access</span> <span class="kw">&lt;-</span> <span class="fl">TRUE</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">sevenbridges</span> <span class="kw">=</span> <span class="no">opt</span>)</pre></body></html></div>
<p>at the beginning of their scripts. Let’s check if the option has been enabled:</p>
<div class="sourceCode" id="cb79"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"sevenbridges"</span>)$<span class="no">advance_access</span></pre></body></html></div>
<pre><code>## [1] TRUE</code></pre>
<p>Send the API call again:</p>
<div class="sourceCode" id="cb81"><html><body><pre class="r"><span class="no">req</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/api.html">api</a></span>(
  <span class="kw">token</span> <span class="kw">=</span> <span class="st">"your_token"</span>, <span class="kw">path</span> <span class="kw">=</span> <span class="st">"genome/markers?file={bam_file_id}"</span>,
  <span class="kw">method</span> <span class="kw">=</span> <span class="st">"GET"</span>
)</pre></body></html></div>
<p>The information of the markers available on that BAM file will be returned:</p>
<div class="sourceCode" id="cb82"><html><body><pre class="r"><span class="kw pkg">httr</span><span class="kw ns">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/content.html">content</a></span>(<span class="no">req</span>)</pre></body></html></div>
<pre><code>$href
[1] "https://api.sbgenomics.com/v2/genome/markers?file={bam_file_id}&amp;offset=0&amp;limit=2"

$items
$items[[1]]
$items[[1]]$href
[1] "https://api.sbgenomics.com/v2/genome/markers/{bam_file_id}"

$items[[1]]$id
[1] "{bam_file_id}"

$items[[1]]$name
[1] "Marker Title"

$items[[2]]
$items[[2]]$href
[1] "https://api.sbgenomics.com/v2/genome/markers/{bam_file_id}"

$items[[2]]$id
[1] "{bam_file_id}"

$items[[2]]$name
[1] "Marker Title"

$links
list()</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="query-parameter-fields" class="section level2">
<h2 class="hasAnchor">
<a href="#query-parameter-fields" class="anchor"></a>Query Parameter <code>'fields'</code>
</h2>
<p>Please read the documentation <a href="https://docs.sevenbridges.com/reference#section-general-api-information">detail</a>.</p>
<p>All API calls take the optional query parameter fields. This parameter enables you to specify the fields you want to be returned when listing resources (e.g., all your projects) or getting details of a specific resource (e.g., a given project).</p>
<p>The fields parameter can be used in the following ways:</p>
<ol style="list-style-type: decimal">
<li><p>No <code>fields</code> parameter specified: calls return default fields. For calls that return complete details of a single resource, this is all their properties; for calls that list resources of a certain type, this is some default properties.</p></li>
<li><p>The <code>fields</code> parameter can be set to a list of fields: for example, to return the fields id, name and size for files in a project, you may issue the call <code>p$file(fields = "id,name,size")</code></p></li>
<li><p>The fields parameter can be used to exclude a specific file: if you wish to omit certain field from the response, do so using the fields parameter with the prefix <code>!</code>. For example, to get the details of a file without listing its metadata, issue a call <code>p$file(fields = '!metadata')</code> The entire metadata field will be removed from the response.</p></li>
<li><p>The fields parameter can be used to include or omit certain nested fields, in the same way as listed in 2 and 3 above: for example, you can use <code>metadata.sample_id</code> or <code>origin.task</code> for files.</p></li>
<li><p>To see all fields for a resource, specify <code>fields="_all"</code>. This returns all fields for each resource returned. Note that if you are getting the details of a specific resource, the use of <code>fields="_all"</code> won’t return any more properties than would have been shown without this parameter — the use case is instead for when you are listing details of many resources. Please use with care if your resource has particularly large fields; for example, the raw field for an app resource contains the complete CWL specification of the app which can result in bulky response if listing many apps.</p></li>
<li><p>Negations and nesting can be combined freely, so, for example, you can issue <code>p$file(fields="id,name,status,!metadata.library,!origin")</code> or <code>p$task(fields="!inputs,!outputs")</code>.</p></li>
</ol>
<p>Please try the following examples.</p>
<div class="sourceCode" id="cb84"><html><body><pre class="r"><span class="co">## default fields id, name, project</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>()
<span class="co">## return file(s) with id, name, siae information</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">fields</span> <span class="kw">=</span> <span class="st">"id,name,size"</span>)
<span class="co">## return file(s) with all available info</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">detail</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">## same as above</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">fields</span> <span class="kw">=</span> <span class="st">"_all"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="rate-limits" class="section level2">
<h2 class="hasAnchor">
<a href="#rate-limits" class="anchor"></a>Rate Limits</h2>
<p>This call returns information about your current rate limit. This is the number of API calls you can make in one hour.</p>
<div class="sourceCode" id="cb85"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">rate_limit</span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="users" class="section level2">
<h2 class="hasAnchor">
<a href="#users" class="anchor"></a>Users</h2>
<p>This call returns a list of the resources, such as projects, billing groups, and organizations, that are accessible to you. Currently, this call will only return a successful response if {username} is replaced with your own username. Be sure to capitalize your username in the same way as when you registered for an account.</p>
<p>If you did not provide a username, it will show your user information.</p>
<div class="sourceCode" id="cb86"><html><body><pre class="r"><span class="co"># return your information</span>
<span class="no">a</span>$<span class="fu">user</span>()
<span class="co"># return user RFranklin's information</span>
<span class="no">a</span>$<span class="fu">user</span>(<span class="st">"RFranklin"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="billing-group-and-invoices" class="section level2">
<h2 class="hasAnchor">
<a href="#billing-group-and-invoices" class="anchor"></a>Billing Group and Invoices</h2>
<div id="for-billing" class="section level3">
<h3 class="hasAnchor">
<a href="#for-billing" class="anchor"></a>For billing</h3>
<p>If no billing group <code>id</code> is provided, this call returns a list of paths used to access billing information via the API. If a username is provided, this call lists all your billing groups, including groups that are pending or which have been disabled. If you specify <code>breakdown = TRUE</code>, the call below returns a breakdown of the spending per-project for the billing group specified by billing_group. Information is also displayed for each of the projects a particular billing group is associated with, including task executions, their initiating user, start and end time, and their cost.</p>
<div class="sourceCode" id="cb87"><html><body><pre class="r"><span class="co"># return a BillingList object</span>
(<span class="no">b</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">billing</span>())
<span class="no">a</span>$<span class="fu">billing</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">b</span>$<span class="no">id</span>, <span class="kw">breakdown</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="for-invoices" class="section level3">
<h3 class="hasAnchor">
<a href="#for-invoices" class="anchor"></a>For invoices</h3>
<p>If no Billing Group <code>id</code> provided, This call returns a list of invoices, with information about each, including whether or not the invoice is pending and the billing period it covers. This call returns information about all your available invoices unless you use the query parameter bg_id to specify the ID of a particular Billing Group, in which case it will return the invoice incurred by that Billing Group only. If an invoice <code>id</code> is provided, this call retrieves information about the specified invoice, including the costs for analysis and storage and the invoice period.</p>
<div class="sourceCode" id="cb88"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">invoice</span>()
<span class="no">a</span>$<span class="fu">invoice</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"your_id"</span>)</pre></body></html></div>
<p><strong><em>Note:</em></strong> Currently, invoice is not an object. Instead, it just returns a regular R list.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="project" class="section level2">
<h2 class="hasAnchor">
<a href="#project" class="anchor"></a>Project</h2>
<p>Projects are the basic units to organize different entities: files, tasks, apps, etc. As such, many actions stem from the <code>Project</code> object.</p>
<div align="right">
<a href="#top">top</a>
</div>
<div id="list-all-projects" class="section level3">
<h3 class="hasAnchor">
<a href="#list-all-projects" class="anchor"></a>List all projects</h3>
<p>The following call returns a list of all projects of which you are a member. Each project’s <code>project_id</code> and the path will be returned.</p>
<div class="sourceCode" id="cb89"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">project</span>()</pre></body></html></div>
<p>If you want to list the projects owned by and accessible to a particular user, specify the <code>owner</code> argument as follows. Each project’s ID and path will be returned.</p>
<div class="sourceCode" id="cb90"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">project</span>(<span class="kw">owner</span> <span class="kw">=</span> <span class="st">"RFranklin"</span>)
<span class="no">a</span>$<span class="fu">project</span>(<span class="kw">owner</span> <span class="kw">=</span> <span class="st">"Rosalind.Franklin"</span>)</pre></body></html></div>
<p>To get details about the project(s), use <code>detail = TRUE</code>, as shown below.</p>
<div class="sourceCode" id="cb91"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">project</span>(<span class="kw">detail</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="partial-match-project-name" class="section level3">
<h3 class="hasAnchor">
<a href="#partial-match-project-name" class="anchor"></a>Partial match project name</h3>
<p>For a more friendly interface and convenient search, the <code>sevenbridges</code> package supports <em>partial name matching</em>. The first argument for the following request is <code>name</code>.</p>
<div class="sourceCode" id="cb92"><html><body><pre class="r"><span class="co"># want to return a project called</span>
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"hello"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="filter-by-project-creation-date-modification-date-and-creator" class="section level3">
<h3 class="hasAnchor">
<a href="#filter-by-project-creation-date-modification-date-and-creator" class="anchor"></a>Filter by project creation date, modification date, and creator</h3>
<p>Project creation date, modification date, and creator information is useful for quickly locating the project you need, especially when you want to follow the life cycle of a large number of projects and distinguish recent projects from old ones. To facilitate such needs, the fields <code>created_by</code>, <code>created_on</code>, and <code>modified_on</code> are returned in the project query calls:</p>
<div class="sourceCode" id="cb93"><html><body><pre class="r"><span class="co"># return all projects matching the name "wgs"</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="st">"wgs"</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># filter by project creators</span>
<span class="no">creators</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">p</span>, <span class="st">"[["</span>, <span class="st">"created_by"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">creator</span> <span class="kw">==</span> <span class="st">"RFranklin"</span>)

<span class="co"># filter by project creation date</span>
<span class="no">create_date</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">p</span>, <span class="st">"[["</span>, <span class="st">"created_on"</span>))
<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="no">create_date</span>) <span class="kw">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="st">"2019-01-01"</span>))

<span class="co"># filter by project modification date</span>
<span class="no">modify_date</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">p</span>, <span class="st">"[["</span>, <span class="st">"modified_on"</span>))
<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="no">modify_date</span>) <span class="kw">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="st">"2019-01-01"</span>))</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-new-project" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-new-project" class="anchor"></a>Create a new project</h3>
<p>To create a new project, users need to specify the following:</p>
<ul>
<li>
<code>name</code> (required)</li>
<li>
<code>billing_group_id</code> (required)</li>
<li>
<code>description</code> (optional)</li>
<li>
<code>tags</code> (optional): This has to be a list(). If you are using the API on the CGC environment, you can create a TCGA Controlled Data project by specifying <code>TCGA</code> in <code>tags</code>.</li>
<li>
<code>type</code> (optional): By default, we create a V2, CWL compatible project.</li>
</ul>
<div class="sourceCode" id="cb94"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">project_new</span>(<span class="st">"api_testing_tcga"</span>, <span class="no">b</span>$<span class="no">id</span>,
  <span class="kw">description</span> <span class="kw">=</span> <span class="st">"Test for API"</span>
)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-new-project-with-tcga-controlled-data-on-cgc" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-new-project-with-tcga-controlled-data-on-cgc" class="anchor"></a>Create a new project with TCGA controlled data on CGC</h3>
<p>Follow the directions above, but pass <code>tcga</code> as a value for <code>tags</code>.</p>
<div class="sourceCode" id="cb95"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">project_new</span>(<span class="st">"controlled_project"</span>, <span class="no">b</span>$<span class="no">id</span>,
  <span class="kw">description</span> <span class="kw">=</span> <span class="st">"Test for API"</span>, <span class="kw">tags</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"tcga"</span>)
)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-a-project" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-a-project" class="anchor"></a>Delete a project</h3>
<p>You can delete a <em>single</em> project by making the request to <code>$delete()</code>. Note that the returned object from <code>a$project()</code> sometimes returns list if you use partial matching by name. The <code>$delete()</code> request cannot operate on a list. If you want to operate on a list of object, read more about batch functions in the relevant section below.</p>
<div class="sourceCode" id="cb96"><html><body><pre class="r"><span class="co"># remove it, not run</span>
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"api_testing"</span>)$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()
<span class="co"># check</span>
<span class="co"># will delete all projects match the name</span>
<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>(<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"api_testing_donnot_delete_me"</span>))</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="updateedit-a-project" class="section level3">
<h3 class="hasAnchor">
<a href="#updateedit-a-project" class="anchor"></a>Update/edit a project</h3>
<p>You can update the following information about an existing project:</p>
<ul>
<li><code>name</code></li>
<li><code>description</code></li>
<li><code>billing_group_id</code></li>
</ul>
<div class="sourceCode" id="cb97"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/helloworld"</span>)
<span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/helloworld"</span>)$<span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Hello World Update"</span>,
  <span class="kw">description</span> <span class="kw">=</span> <span class="st">"Update description"</span>
)</pre></body></html></div>
</div>
<div id="project-member" class="section level3">
<h3 class="hasAnchor">
<a href="#project-member" class="anchor"></a>Project member</h3>
<div id="list-members" class="section level4">
<h4 class="hasAnchor">
<a href="#list-members" class="anchor"></a>List members</h4>
<p>This call returns a list of the members of the specified project. For each member, the response lists:</p>
<ul>
<li>The member’s username</li>
<li>The member’s permissions in the specified project</li>
</ul>
<div class="sourceCode" id="cb98"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/demo-project"</span>)$<span class="fu">member</span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="add-a-member" class="section level4">
<h4 class="hasAnchor">
<a href="#add-a-member" class="anchor"></a>Add a member</h4>
<p>This call adds a new user to the specified project. It can only be made by a user who has admin permissions in the project.</p>
<p>Requests to add a project member must include the key <code>permissions</code>. However, if you do not include a value, the member’s permissions will be set to <code>false</code> by default.</p>
<p>Set permission by passing the following values: <code>copy</code>, <code>write</code>, <code>execute</code>, <code>admin</code>, or <code>read</code>.</p>
<p>Note: <code>read</code> is implicit and set by default. You can not be a project member without having <code>read</code> permissions.</p>
<div class="sourceCode" id="cb99"><html><body><pre class="r"><span class="no">m</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/demo-project"</span>)$
  <span class="fu">member_add</span>(<span class="kw">username</span> <span class="kw">=</span> <span class="st">"Rosalind.Franklin"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="update-a-member" class="section level4">
<h4 class="hasAnchor">
<a href="#update-a-member" class="anchor"></a>Update a member</h4>
<p>This call edits a user’s permissions in the specified project. It can only be made by a user who has admin permissions in the project.</p>
<div class="sourceCode" id="cb100"><html><body><pre class="r"><span class="no">m</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/demo-project"</span>)$
  <span class="fu">member</span>(<span class="kw">username</span> <span class="kw">=</span> <span class="st">"Rosalind.Franklin"</span>)
<span class="no">m</span>$<span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(<span class="kw">copy</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<pre><code>== Member ==
username : Rosalind.Franklin
-- Permission --
read : TRUE
write : FALSE
copy_permission : TRUE
execute : FALSE
admin : FALSE</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-a-member" class="section level4">
<h4 class="hasAnchor">
<a href="#delete-a-member" class="anchor"></a>Delete a member</h4>
<p>To delete an existing member, call the <code><a href="../reference/delete-methods.html">delete()</a></code> action on the <code>Member</code> object.</p>
<div class="sourceCode" id="cb102"><html><body><pre class="r"><span class="no">m</span>$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()
<span class="co"># confirm</span>
<span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/demo-project"</span>)$<span class="fu">member</span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="list-all-files" class="section level3">
<h3 class="hasAnchor">
<a href="#list-all-files" class="anchor"></a>List all files</h3>
<p>To list all files belonging to a project, use the following request:</p>
<div class="sourceCode" id="cb103"><html><body><pre class="r"><span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/demo-project"</span>)
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="files-metadata-and-tags" class="section level2">
<h2 class="hasAnchor">
<a href="#files-metadata-and-tags" class="anchor"></a>Files, Metadata, and Tags</h2>
<div id="list-all-files-1" class="section level3">
<h3 class="hasAnchor">
<a href="#list-all-files-1" class="anchor"></a>List all files</h3>
<p>A better way to list files in a project uses the following:</p>
<div class="sourceCode" id="cb104"><html><body><pre class="r"><span class="co"># first 100 files, default offset = 0, limit = 100</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>()
<span class="co"># list all files</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>Alternatively, you can get files from the <code>Auth</code> object.</p>
<div class="sourceCode" id="cb105"><html><body><pre class="r"><span class="no">a</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">project</span> <span class="kw">=</span> <span class="no">p</span>$<span class="no">id</span>)
<span class="no">a</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"omni"</span>, <span class="kw">project</span> <span class="kw">=</span> <span class="no">p</span>$<span class="no">id</span>, <span class="kw">detail</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-and-filter-files" class="section level3">
<h3 class="hasAnchor">
<a href="#search-and-filter-files" class="anchor"></a>Search and filter file(s)</h3>
<div id="rule-of-thumb" class="section level4">
<h4 class="hasAnchor">
<a href="#rule-of-thumb" class="anchor"></a>Rule of thumb</h4>
<p>You can easily search by partial name, exact name, or id for many items like project, apps, files. Fortunately, we have more powerful filters for files. The user could search by metadata, tags, and the original task ID.</p>
<ol style="list-style-type: decimal">
<li><p><strong>First rule: understand the scope</strong>: We know we have default <code>limit = 100</code> and <code>offset = 0</code> for first 100 items, unless you are using arguments <code>complete = TRUE</code>. Things are different when it comes to files. When you search with exact name (search by name with <code>exact = TRUE</code> on), metadata, or tags, it searches through ALL files. You do not have to specify <code>complete = TRUE</code>. Simply provide the project id or make the call from a project object as shown below.</p></li>
<li><p><strong>Second rule: understand the operation</strong>: When filtering on any resource, including the same field several times with different filtering criteria results in an implicit OR operation for that field and the different criteria.When filtering by different specified fields, an implicit AND is performed between those criteria." so which are different fields, metadata, origin.task, tags, those are different fields. <strong>Note</strong> different metadata fields are treated as different fields as well, so it will be an <strong>AND</strong> operation for different metadata fields.</p></li>
</ol>
<p>As a quick example, the following code gives us all files in the project <code>RFranklin/demo</code> that with metadata sample_id “Sample1” <strong>OR</strong> “Sample2”, <strong>AND</strong> the library id has to be “EXAMPLE”, <strong>AND</strong> tags has either “hello” <strong>OR</strong> “world”.</p>
<div class="sourceCode" id="cb106"><html><body><pre class="r"><span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/demo"</span>)
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(
  <span class="kw">metadata</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">sample_id</span> <span class="kw">=</span> <span class="st">"Sample1"</span>,
    <span class="kw">sample_id</span> <span class="kw">=</span> <span class="st">"Sample2"</span>,
    <span class="kw">library_id</span> <span class="kw">=</span> <span class="st">"EXAMPLE"</span>
  ),
  <span class="kw">tag</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hello"</span>, <span class="st">"world"</span>)
)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-name-and-id" class="section level4">
<h4 class="hasAnchor">
<a href="#search-by-name-and-id" class="anchor"></a>Search by name and id</h4>
<p>There are two ways to return the exact file you want. One is by <code>id</code>, the other one is by exact <code>name</code>.</p>
<p><strong><em>For advanced users:</em></strong> When searching by name with <code>exact = TRUE</code>, it directly uses our public API call to match the exact name and return the object with a single query. When you turn off <code>exact</code>, it will <code>grep</code> all files or files defined with <code>limit</code> and <code>offset</code> first, then match by name, which could be slow.</p>
<p>To get the file id, you can check the URL on the web interface from the file details page.</p>
<div class="sourceCode" id="cb107"><html><body><pre class="r"><span class="co"># return single object id is "some_file_id"</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"some_file_id"</span>)
<span class="co"># return a single object named a.fastq</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"a.fastq"</span>, <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># public file search using Auth object</span>
<span class="no">a</span>$<span class="fu">public_file</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"ucsc.hg19.fasta.fai"</span>, <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">a</span>$<span class="fu">public_file</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"578cf94a507c17681a3117e8"</span>)</pre></body></html></div>
<p>To get more than one object, the arguments <code>id</code> and <code>name</code> both accept vectors, so you can pass more than one <code>id</code> or <code>name</code> to it.</p>
<div class="sourceCode" id="cb108"><html><body><pre class="r"><span class="co"># get two files</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"test1.fastq"</span>, <span class="st">"test2.fastq"</span>), <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># get two files from public files using shorthand</span>
<span class="no">a</span>$<span class="fu">public_file</span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ucsc.hg19.fasta.fai"</span>, <span class="st">"ucsc.hg19.fasta"</span>),
  <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>
)</pre></body></html></div>
<p>If you did not use <code>exact = TRUE</code>, the API would assume it is pattern grep and use partial matching.</p>
<div class="sourceCode" id="cb109"><html><body><pre class="r"><span class="co"># get matchd the pattern for searching first 100 files</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gz"</span>, <span class="st">"fastq"</span>))
<span class="co"># get all matched files from the project</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gz"</span>, <span class="st">"fastq"</span>), <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># get all files matched ucsc</span>
<span class="no">a</span>$<span class="fu">public_file</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"ucsc.hg19"</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-metadata" class="section level4">
<h4 class="hasAnchor">
<a href="#search-by-metadata" class="anchor"></a>Search by metadata</h4>
<p>When you specify different metadata fields, the values use an <strong>AND</strong> operation, and when you specify the same metadata fields, the values use an <strong>OR</strong> operation.</p>
<p>To list all files in project <code>RFranklin/demo</code>, that have a <code>sample_id</code> of “Sample1” <strong>OR</strong> “Sample2” <strong>AND</strong> another metadata field library_id set to “EXAMPLE”, make the following request.</p>
<div class="sourceCode" id="cb110"><html><body><pre class="r"><span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/demo"</span>)
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">metadata</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">sample_id</span> <span class="kw">=</span> <span class="st">"Sample1"</span>,
  <span class="kw">sample_id</span> <span class="kw">=</span> <span class="st">"Sample2"</span>,
  <span class="kw">library_id</span> <span class="kw">=</span> <span class="st">"EXAMPLE"</span>
))</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-tags" class="section level4">
<h4 class="hasAnchor">
<a href="#search-by-tags" class="anchor"></a>Search by tags</h4>
<p>Tags are more flexible than metadata. You can search with multiple tags using an <strong>OR</strong> operation.</p>
<p>This example shows how to return all files with the tag “s1” <strong>OR</strong> “s2”.</p>
<div class="sourceCode" id="cb111"><html><body><pre class="r"><span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/demo"</span>)
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">tag</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"s1"</span>, <span class="st">"s2"</span>))</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-original-task-id" class="section level4">
<h4 class="hasAnchor">
<a href="#search-by-original-task-id" class="anchor"></a>Search by original task id</h4>
<p>You can also get all files from a task. There are two ways to do it:</p>
<ol style="list-style-type: decimal">
<li>Started from the <code>Task</code> object;</li>
<li>Use the filter criteria.</li>
</ol>
<div class="sourceCode" id="cb112"><html><body><pre class="r"><span class="co"># list all outputs file from a task id</span>
<span class="no">a</span>$<span class="fu">task</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"53020538-6936-422f-80de-02fa65ae4b39"</span>)$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>()

<span class="co"># OR</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/demo"</span>)
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">origin.task</span> <span class="kw">=</span> <span class="st">"53020538-6936-422f-80de-02fa65ae4b39"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="copy-a-file-or-group-of-files" class="section level3">
<h3 class="hasAnchor">
<a href="#copy-a-file-or-group-of-files" class="anchor"></a>Copy a file or group of files</h3>
<p>This call copies the specified file to a new project. Files retain their metadata when copied, but may be assigned new names in their target project.</p>
<p>Note that Controlled Data files may not be copied to Open Data projects. To make this request, you should have copy permission within the project you are copying from.</p>
<p>Let’s try to copy a file from the Public File repository. The file’s id is “561e1b33e4b0aa6ec48167d7”.</p>
<p>You must provide</p>
<ul>
<li>
<code>id</code>: file id or list/vector of files ids</li>
<li>
<code>project</code>: project id.</li>
<li>
<code>name</code> (optional):if omitted, use the same name as the original file name</li>
</ul>
<div class="sourceCode" id="cb113"><html><body><pre class="r"><span class="co"># 1000G_omni2.5.b37.vcf</span>
<span class="no">fid</span> <span class="kw">&lt;-</span> <span class="st">"561e1b33e4b0aa6ec48167d7"</span>
<span class="no">fid2</span> <span class="kw">&lt;-</span> <span class="st">"561e1b33e4b0aa6ec48167d3"</span>
<span class="no">pid</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="no">id</span>
<span class="no">a</span>$<span class="fu">copyFile</span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">fid</span>, <span class="no">fid2</span>), <span class="kw">project</span> <span class="kw">=</span> <span class="no">pid</span>)
<span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">pid</span>)$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>()</pre></body></html></div>
<p><strong>NOTE:</strong> To copy a group of files, you need the <code>Auth$copyFile()</code> interface. The <code>id</code> of the files in your project will be different from their <code>id</code> in the Public Files repository.</p>
<p>Alternatively, you copy a <strong>single file</strong> as shown below.</p>
<div class="sourceCode" id="cb114"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">project</span>(<span class="st">"hello"</span>)$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">fid</span>)$<span class="fu">copyTo</span>(<span class="no">pid</span>)</pre></body></html></div>
<p>Notably, if you have many files to copy between projects, we would always recommend using the <code>Auth$bulk_file_copy()</code> method described in the Actions API section below, to batch copy the files in a single API call and save the number of API calls.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-files" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-files" class="anchor"></a>Delete file(s)</h3>
<p><strong><em>Note:</em></strong> The <code>delete</code> action only works for one file at a time. Be sure your <code>file</code> call returns a single file rather than a file list.</p>
<div class="sourceCode" id="cb115"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>()<span class="kw">[[</span><span class="fl">1</span>]]$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()
<span class="co">## confirm the deletion</span>
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>()</pre></body></html></div>
<p>You can also delete a group of files or <code>FilesList</code> object, just <strong>be careful</strong> when using this function.</p>
<div class="sourceCode" id="cb116"><html><body><pre class="r"><span class="co">## return 5 files</span>
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="st">"phase1"</span>)
<span class="co">## delete all of them</span>
<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>(<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="st">"phase1"</span>))
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="st">"phase1"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="download-files" class="section level3">
<h3 class="hasAnchor">
<a href="#download-files" class="anchor"></a>Download files</h3>
<p>To get the download information, please use the following:</p>
<div class="sourceCode" id="cb117"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>()<span class="kw">[[</span><span class="fl">1</span>]]$<span class="fu">download_url</span>()</pre></body></html></div>
<p>To download directly from R, use the <code>download</code> call directly from a single <code>File</code> object.</p>
<div class="sourceCode" id="cb118"><html><body><pre class="r"><span class="no">fid</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>()<span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">id</span>
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">fid3</span>)$<span class="fu"><a href="../reference/download-methods.html">download</a></span>(<span class="st">"~/Downloads/"</span>)</pre></body></html></div>
<p>I also created a <code>download</code> function for <code>FilesList</code> object to save your time, as follows:</p>
<div class="sourceCode" id="cb119"><html><body><pre class="r"><span class="no">fls</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>()
<span class="fu"><a href="../reference/download-methods.html">download</a></span>(<span class="no">fls</span>, <span class="st">"~/Downloads/"</span>)</pre></body></html></div>
<p>To download all files from a project, use the following:</p>
<div class="sourceCode" id="cb120"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu"><a href="../reference/download-methods.html">download</a></span>(<span class="st">"~/Downloads"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="upload-files-via-api" class="section level3">
<h3 class="hasAnchor">
<a href="#upload-files-via-api" class="anchor"></a>Upload files via API</h3>
<p>Seven Bridges platforms provide a few different methods for data import:</p>
<ul>
<li>Import from FTP or HTTP with the web interface</li>
<li>The GUI uploader</li>
<li>The file upload API that you can directly call with the <code>sevenbridges</code> package</li>
<li>The command line uploader which can be invoked with the <code>sevenbridges</code> package</li>
</ul>
<p>Use the API client uploader by calling the <code>project$upload</code> function to upload a file, a file list, or a folder recursively or via a manifest file.</p>
<div id="upload-single-file" class="section level4">
<h4 class="hasAnchor">
<a href="#upload-single-file" class="anchor"></a>Upload single file</h4>
<div class="sourceCode" id="cb121"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">username</span> <span class="kw">=</span> <span class="st">"RFranklin"</span>, <span class="kw">platform</span> <span class="kw">=</span> <span class="st">"cgc"</span>)
<span class="no">fl</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"sample1.fastq"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"sevenbridges"</span>)

(<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/quickstart"</span>))

<span class="co"># by default load .meta for the file</span>
<span class="no">p</span>$<span class="fu">upload</span>(<span class="no">fl</span>, <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># pass metadata</span>
<span class="no">p</span>$<span class="fu">upload</span>(<span class="no">fl</span>, <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">metadata</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">library_id</span> <span class="kw">=</span> <span class="st">"testid2"</span>, <span class="kw">platform</span> <span class="kw">=</span> <span class="st">"Illumina x11"</span>))
<span class="co"># rename</span>
<span class="no">p</span>$<span class="fu">upload</span>(<span class="no">fl</span>,
  <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">name</span> <span class="kw">=</span> <span class="st">"sample_new_name.fastq"</span>,
  <span class="kw">metadata</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">library_id</span> <span class="kw">=</span> <span class="st">"new_id"</span>)
)</pre></body></html></div>
</div>
<div id="upload-a-folder" class="section level4">
<h4 class="hasAnchor">
<a href="#upload-a-folder" class="anchor"></a>Upload a folder</h4>
<div class="sourceCode" id="cb122"><html><body><pre class="r"><span class="no">dir.ext</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"sevenbridges"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="no">dir.ext</span>)
<span class="no">p</span>$<span class="fu">upload</span>(<span class="no">dir.ext</span>, <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
</div>
<div id="upload-a-list-of-files" class="section level4">
<h4 class="hasAnchor">
<a href="#upload-a-list-of-files" class="anchor"></a>Upload a list of files</h4>
<div class="sourceCode" id="cb123"><html><body><pre class="r"><span class="no">dir.ext</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"sevenbridges"</span>)
<span class="co"># enable full name</span>
<span class="no">fls</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="no">dir.ext</span>, <span class="kw">recursive</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">full.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">p</span>$<span class="fu">upload</span>(<span class="no">fls</span>, <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">p</span>$<span class="fu">upload</span>(<span class="st">"~/Documents/Data/sbgtest/1000G_phase1.snps.high_confidence.b37.vcf"</span>)</pre></body></html></div>
</div>
<div id="upload-files-via-a-defined-manifest-file" class="section level4">
<h4 class="hasAnchor">
<a href="#upload-files-via-a-defined-manifest-file" class="anchor"></a>Upload files via a defined manifest file</h4>
<p>A manifest file is a file used to define metadata values for a set of files. It can be used when uploading files to the platform to set their metadata. The supported file format for the manifest file is CSV. A CSV file contains a number of rows with columns which are separated with a comma. The format of a manifest file is defined in the <a href="https://docs.sevenbridges.com/docs/format-of-a-manifest-file">documentaion</a>.</p>
<p>Some requirements:</p>
<ul>
<li>The first row has to contain column names which are parsed as metadata fields (e.g. <code>sample</code>, <code>library</code>). When it is not customized fields, we do the conversion for meta fields like <code>sample_id</code> which need to be a string.</li>
<li>The first column has to contain the names of the files which will be uploaded. In case the files are not in the same directory as the manifest file, you should also include a path to the files (e.g. <code>../filename.fastq</code>).</li>
</ul>
<p>We allow users to</p>
<ul>
<li>choose to upload metadata or not</li>
<li>choose to use <code>subset</code> to upload only part of the metadata</li>
<li>choose to use <code>subset</code> to upload only part of files with filter</li>
</ul>
<p>Please check the examples below.</p>
<div class="sourceCode" id="cb124"><html><body><pre class="r"><span class="co"># upload all fiels and all metadata</span>
<span class="no">p</span>$<span class="fu">upload</span>(<span class="kw">manifest_file</span> <span class="kw">=</span> <span class="st">"~/manifest.csv"</span>)

<span class="co"># verbal = TRUE, print single file level progress</span>
<span class="no">p</span>$<span class="fu">upload</span>(<span class="kw">manifest_file</span> <span class="kw">=</span> <span class="st">"~/manifest.csv"</span>, <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">verbal</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># manifest_metadata = FALSE doens't attach any metadata</span>
<span class="no">p</span>$<span class="fu">upload</span>(<span class="kw">manifest_file</span> <span class="kw">=</span> <span class="st">"~/manifest.csv"</span>, <span class="kw">manifest_metadata</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># filter files first, upload only files with score &lt; 0.5</span>
<span class="no">p</span>$<span class="fu">upload</span>(<span class="kw">manifest_file</span> <span class="kw">=</span> <span class="st">"~/manifest.csv"</span>, <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">subset</span> <span class="kw">=</span> <span class="no">score</span> <span class="kw">&lt;</span> <span class="fl">0.5</span>)

<span class="co"># attach all meta except "bad_field" and "sample_id"</span>
<span class="no">p</span>$<span class="fu">upload</span>(
  <span class="kw">manifest_file</span> <span class="kw">=</span> <span class="st">"~/manifest.csv"</span>, <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">subset</span> <span class="kw">=</span> <span class="no">score</span> <span class="kw">&lt;</span> <span class="fl">0.5</span>, <span class="kw">select</span> <span class="kw">=</span> -<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">bad_field</span>, <span class="no">sample_id</span>)
)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="upload-files-via-command-line-uploader" class="section level3">
<h3 class="hasAnchor">
<a href="#upload-files-via-command-line-uploader" class="anchor"></a>Upload files via command line uploader</h3>
<p>As an alternative to API file uploading, we also offer an interface in the <code>sevenbridges</code> package for uploading (possibly large) files via the Java-based command line uploader.</p>
<p>The first step is to download the command line uploader. With <code><a href="../reference/get_uploader.html">get_uploader()</a></code>, users can easily download the uploader to a local directory for a specified Seven Bridges platform, for example, the Cancer Genomics Cloud:</p>
<div class="sourceCode" id="cb125"><html><body><pre class="r"><span class="fu"><a href="../reference/get_uploader.html">get_uploader</a></span>(<span class="st">"cgc"</span>, <span class="st">"~/Downloads/"</span>)</pre></body></html></div>
<p>To list the available projects accessible from your account via the uploader, use <code><a href="../reference/cli_list_projects.html">cli_list_projects()</a></code>, with your authentication token for that platform and the directory containing the uploader:</p>
<div class="sourceCode" id="cb126"><html><body><pre class="r"><span class="no">cgc_token</span> <span class="kw">&lt;-</span> <span class="st">"your_cgc_token"</span>
<span class="no">cgc_uploader</span> <span class="kw">&lt;-</span> <span class="st">"~/Downloads/cgc-uploader/"</span>

<span class="fu"><a href="../reference/cli_list_projects.html">cli_list_projects</a></span>(
  <span class="kw">token</span> <span class="kw">=</span> <span class="no">cgc_token</span>,
  <span class="kw">uploader</span> <span class="kw">=</span> <span class="no">cgc_uploader</span>
)</pre></body></html></div>
<p>The function will return a character vector containing the available projects which you could upload files to, in the form of <code>username/project-name</code>.</p>
<p>Similarly, to list all the file tags in a project via the uploader, use <code><a href="../reference/cli_list_tags.html">cli_list_tags()</a></code>:</p>
<div class="sourceCode" id="cb127"><html><body><pre class="r"><span class="fu"><a href="../reference/cli_list_tags.html">cli_list_tags</a></span>(
  <span class="kw">token</span> <span class="kw">=</span> <span class="no">cgc_token</span>,
  <span class="kw">uploader</span> <span class="kw">=</span> <span class="no">cgc_uploader</span>,
  <span class="kw">project</span> <span class="kw">=</span> <span class="st">"username/project-name"</span>
)</pre></body></html></div>
<p>Eventually, use <code><a href="../reference/cli_upload.html">cli_upload()</a></code> to upload local files to a project:</p>
<div class="sourceCode" id="cb128"><html><body><pre class="r"><span class="fu"><a href="../reference/cli_upload.html">cli_upload</a></span>(
  <span class="kw">token</span> <span class="kw">=</span> <span class="no">cgc_token</span>,
  <span class="kw">uploader</span> <span class="kw">=</span> <span class="no">cgc_uploader</span>,
  <span class="kw">file</span> <span class="kw">=</span> <span class="st">"~/example.fastq"</span>,
  <span class="kw">project</span> <span class="kw">=</span> <span class="st">"username/project-name"</span>
)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="update-a-file" class="section level3">
<h3 class="hasAnchor">
<a href="#update-a-file" class="anchor"></a>Update a file</h3>
<p>You can call the <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> function from the Files object. With this call, the following can be updated:</p>
<ul>
<li>The file’s <code>name</code>.</li>
<li>The file’s <code>metadata</code>. The metadata is in the form of a list. Note that as this call overwrites all the metadata for a given file, please supply a full list of all the metadata for the file. Conversely, you can use the <a href="#set_metadata"><code>set_meta()</code> function</a> to patch but not overwrite the metadata for a file.</li>
</ul>
<p>If no parameters were provided, this call will get the details of that file and update the object itself.</p>
<div class="sourceCode" id="cb129"><html><body><pre class="r">(<span class="no">fl</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/demo-project"</span>)$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"sample.fastq"</span>))</pre></body></html></div>
<pre><code>== File ==
id : 56c7916ae4b03b56a7d7
name : sample.fastq
project : RFranklin/demo-project</code></pre>
<p><strong>Show metadata</strong></p>
<div class="sourceCode" id="cb131"><html><body><pre class="r"><span class="co"># show metadata</span>
<span class="no">fl</span>$<span class="fu">meta</span>()</pre></body></html></div>
<p><strong>Update meta</strong></p>
<div class="sourceCode" id="cb132"><html><body><pre class="r"><span class="no">fl</span>$<span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"sample.fastq"</span>,
  <span class="kw">metadata</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">new_item1</span> <span class="kw">=</span> <span class="st">"item1"</span>,
    <span class="kw">new_item2</span> <span class="kw">=</span> <span class="st">"item2"</span>,
    <span class="kw">file_extension</span> <span class="kw">=</span> <span class="st">"fastq"</span>
  )
)
<span class="co"># check it out</span>
<span class="no">fl</span>$<span class="fu">meta</span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="metadata-operations" class="section level3">
<h3 class="hasAnchor">
<a href="#metadata-operations" class="anchor"></a>Metadata operations</h3>
<p>Learn about metadata fields and their values for the relevant environment: [<a href="https://docs.sevenbridges.com/docs/metadata-on-the-seven-bridges-platform">Seven Bridges Platform</a>] [<a href="http://docs.cancergenomicscloud.org/v1.0/docs/metadata-for-private-data">CGC</a>].</p>
<p>Note that the name of a file is not the same as its ID. A file’s ID is a hexadecimal string automatically assigned to a file in a project. The file’s name is a human-readable string. For information, please see the API overview for the <a href="https://docs.sevenbridges.com/v1.0/docs/the-api">Seven Bridges Platform</a> and for the <a href="http://docs.cancergenomicscloud.org/docs/the-cgc-api">CGC</a>.</p>
<p><strong>Get metadata</strong></p>
<p>To get the metadata for a file, call the <code>meta()</code> function, as shown below.</p>
<div class="sourceCode" id="cb133"><html><body><pre class="r"><span class="co"># meta is pulling the latest information via API</span>
<span class="no">fl</span>$<span class="fu">meta</span>()
<span class="co"># field metadata saved the previously saved one</span>
<span class="no">fl</span>$<span class="no">metadata</span></pre></body></html></div>
<p><a name="set_metadata"></a> <strong>Set metadata</strong></p>
<p>Files from curated datasets on Seven Bridges environments have a defined set of metadata which is visible on the visual interface of each environment. However, you can also pass additional metadata for each file which is stored with your copy of the file in your project.</p>
<p>To set metadata but not overwrite all previously stored metadata, call the <code>set_meta()</code> function from the Files object. Unlike the <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> function for the Files object, the <code>set_meta()</code> function doesn’t overwrite the metadata field. To overwrite the metadata field, use the <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> function or pass the optional argument <code>overwrite = TRUE</code> for the <code>set_meta()</code> call.</p>
<div class="sourceCode" id="cb134"><html><body><pre class="r"><span class="no">fl</span>$<span class="fu">set_meta</span>(<span class="kw">new_item3</span> <span class="kw">=</span> <span class="st">"item3"</span>)
<span class="no">fl</span>
<span class="co"># oops it removed rest of the meta</span>
<span class="no">fl</span>$<span class="fu">set_meta</span>(<span class="kw">new_item4</span> <span class="kw">=</span> <span class="st">"item4"</span>, <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">fl</span></pre></body></html></div>
<p><strong>Check details of each metadata field</strong></p>
<p>You can use the <code><a href="../reference/Metadata.html">Metadata()</a></code> constructor to check the details of each metadata field. Simply call the function (name of the metadata) to display descriptions and enumerated items. Please pay attention to the <code>suggested_values</code> field.</p>
<div class="sourceCode" id="cb135"><html><body><pre class="r"><span class="co"># check which schema we have</span>
<span class="fu"><a href="../reference/Metadata.html">Metadata</a></span>()$<span class="fu">show</span>(<span class="kw">full</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># check details for each, play with it</span>
<span class="fu"><a href="../reference/Metadata.html">platform</a></span>()
<span class="fu"><a href="../reference/Metadata.html">paired_end</a></span>()
<span class="fu"><a href="../reference/Metadata.html">quality_scale</a></span>()</pre></body></html></div>
<p>As you can see, some metadata fields have suggested values. To construct the metadata, use <code><a href="../reference/Metadata.html">Metadata()</a></code> directly to pass the metadata fields and their values directly into the call. The call will perform the validation.</p>
<div class="sourceCode" id="cb136"><html><body><pre class="r"><span class="fu"><a href="../reference/Metadata.html">Metadata</a></span>(
  <span class="kw">platform</span> <span class="kw">=</span> <span class="st">"Affymetrix SNP Array 6.0"</span>,
  <span class="kw">paired_end</span> <span class="kw">=</span> <span class="fl">1</span>,
  <span class="kw">quality_scale</span> <span class="kw">=</span> <span class="st">"sanger"</span>,
  <span class="kw">new_item</span> <span class="kw">=</span> <span class="st">"new test"</span>
)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="tag-files" class="section level3">
<h3 class="hasAnchor">
<a href="#tag-files" class="anchor"></a>Tag file(s)</h3>
<p>You can tag your files with keywords or strings to make it easier to identify and organize files. Tags are different from metadata and are more convenient and visible from the files list on the visual interface.</p>
<p><strong>Add a new tag</strong></p>
<p>To add a new tag, call the <code>obj$add_tag()</code> method for the File object with a single tag string or a list or vector of tags.</p>
<p><strong>Overwrite the tags for a file</strong></p>
<p>To completely overwrite the tags for a file, use the <code>obj$set_tag()</code> method, which contains the default argument <code>overwrite = TRUE</code>.</p>
<p>Let’s use a file called <code>sample.bam</code> and play with its tags.</p>
<div class="sourceCode" id="cb137"><html><body><pre class="r"><span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/s3tutorial"</span>)
<span class="no">fl</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="st">"sample.bam"</span>, <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># show tags for single file</span>
<span class="no">fl</span>$<span class="fu">tag</span>()
<span class="co"># add new tags</span>
<span class="no">fl</span>$<span class="fu"><a href="../reference/tag-methods.html">add_tag</a></span>(<span class="st">"new tag"</span>)
<span class="co"># equavilent to</span>
<span class="no">fl</span>$<span class="fu"><a href="../reference/tag-methods.html">set_tag</a></span>(<span class="st">"new tag 2"</span>, <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co"># set tags to overwrite existing</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"this"</span>, <span class="st">"is"</span>, <span class="fl">1234</span>)
<span class="no">fl</span>$<span class="fu"><a href="../reference/tag-methods.html">set_tag</a></span>(<span class="no">x</span>)
<span class="co"># filter by tags</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">tag</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1234"</span>, <span class="st">"new"</span>))
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">tag</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"1234"</span>, <span class="st">"new"</span>))
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">tag</span> <span class="kw">=</span> <span class="st">"1234"</span>)</pre></body></html></div>
<p>Below, find convenient methods for <code>FilesList</code>. Let’s add the tag “s1” to a group files matching “Sample1” and add the tag “s2” to a group of files that match “s2”. Then, we will filter by these tags to obtain specific files.</p>
<div class="sourceCode" id="cb138"><html><body><pre class="r"><span class="co"># work on a group of files</span>
<span class="co"># add tag "s2" to a group of files named with "Sample2" in it</span>
<span class="no">fl2</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="st">"Sample2"</span>)
<span class="fu"><a href="../reference/tag-methods.html">add_tag</a></span>(<span class="no">fl2</span>, <span class="st">"s2"</span>)
<span class="co"># add tag "s2" to a group of files named with "Sample1" in it</span>
<span class="no">fl1</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="st">"Sample1"</span>)
<span class="fu"><a href="../reference/tag-methods.html">add_tag</a></span>(<span class="no">fl1</span>, <span class="st">"s1"</span>)
<span class="co"># filter by tag s1 or s2</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">tag</span> <span class="kw">=</span> <span class="st">"s1"</span>)
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">tag</span> <span class="kw">=</span> <span class="st">"s2"</span>)
<span class="co"># get files tagged with s2 and 1234</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">tag</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"s2"</span>, <span class="st">"s1"</span>))</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="folders" class="section level2">
<h2 class="hasAnchor">
<a href="#folders" class="anchor"></a>Folders</h2>
<p>The Folders API allows you to organize your files using folders in projects. From a filesystem perspective, folders are simply a special type of file. Therefore, within this package, the folder objects are still represented using the same class as the file objects above, only with specific methods for operating on them.</p>
<div align="right">
<a href="#top">top</a>
</div>
<div id="get-project-root-folder" class="section level3">
<h3 class="hasAnchor">
<a href="#get-project-root-folder" class="anchor"></a>Get project root folder</h3>
<p>To create new folders and manage files using folders in a project, we first need to get the information about the root folder of the project. For example</p>
<div class="sourceCode" id="cb139"><html><body><pre class="r"><span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/folders-api-testing"</span>)</pre></body></html></div>
<p>We can get the project root folder ID:</p>
<div class="sourceCode" id="cb140"><html><body><pre class="r"><span class="no">p</span>$<span class="fu">get_root_folder_id</span>()</pre></body></html></div>
<pre><code>[1] "5bd7c53ee4b04b8fb1a9f63c"</code></pre>
<p>Or, return the project root folder as an object:</p>
<div class="sourceCode" id="cb142"><html><body><pre class="r">(<span class="no">root_folder</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu">get_root_folder</span>())</pre></body></html></div>
<pre><code>== Files ==
id : 5bd7c53ee4b04b8fb1a9f63c
name : 8c02ceda-e46b-49c0-362f-4318fa8f3e4k
project : RFranklin/folders-api-testing
created_on : 2018-10-29T18:45:50Z
modified_on : 2018-10-29T18:45:50Z
type : folder</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-folder" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-folder" class="anchor"></a>Create a folder</h3>
<p>To create a new_folder under the project root folder, use</p>
<div class="sourceCode" id="cb144"><html><body><pre class="r"><span class="no">folder1</span> <span class="kw">&lt;-</span> <span class="no">root_folder</span>$<span class="fu">create_folder</span>(<span class="st">"folder1"</span>)</pre></body></html></div>
<p>To create a new folder under <code>folder1</code>, use</p>
<div class="sourceCode" id="cb145"><html><body><pre class="r"><span class="no">folder2</span> <span class="kw">&lt;-</span> <span class="no">folder1</span>$<span class="fu">create_folder</span>(<span class="st">"folder2"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="copy-files-between-folders" class="section level3">
<h3 class="hasAnchor">
<a href="#copy-files-between-folders" class="anchor"></a>Copy files between folders</h3>
<p>Let’s copy a public reference file into the project root folder:</p>
<div class="sourceCode" id="cb146"><html><body><pre class="r"><span class="no">file_public</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">public_file</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"Homo_sapiens_assembly38.fasta"</span>, <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">file1</span> <span class="kw">&lt;-</span> <span class="no">file_public</span>$<span class="fu">copy_to_folder</span>(<span class="no">root_folder</span>$<span class="no">id</span>)</pre></body></html></div>
<p>We can also rename the file when copying it into a folder:</p>
<div class="sourceCode" id="cb147"><html><body><pre class="r"><span class="no">file2</span> <span class="kw">&lt;-</span> <span class="no">file_public</span>$<span class="fu">copy_to_folder</span>(<span class="no">root_folder</span>$<span class="no">id</span>, <span class="st">"ref_grch38.fasta"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="move-files-between-folders" class="section level3">
<h3 class="hasAnchor">
<a href="#move-files-between-folders" class="anchor"></a>Move files between folders</h3>
<p>To move files to another folder (for example, <code>folder1</code> we just created), use</p>
<div class="sourceCode" id="cb148"><html><body><pre class="r"><span class="no">file1</span> <span class="kw">&lt;-</span> <span class="no">file1</span>$<span class="fu">move_to_folder</span>(<span class="no">folder1</span>$<span class="no">id</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="list-folder-contents" class="section level3">
<h3 class="hasAnchor">
<a href="#list-folder-contents" class="anchor"></a>List folder contents</h3>
<p>To list all files and folders in a folder (for example, the root folder), use</p>
<div class="sourceCode" id="cb149"><html><body><pre class="r">(<span class="no">contents_root</span> <span class="kw">&lt;-</span> <span class="no">root_folder</span>$<span class="fu">list_folder_contents</span>(<span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>))</pre></body></html></div>
<pre><code>[[1]]
== Files ==
id : 5bede476e4b03b8ff38c28ba
name : folder1
project : RFranklin/folders-api-testing
parent : 5bd7c53ee4b04b8fb1a9f63c
type : folder

[[2]]
== Files ==
id : 5bedc431e4b09b8ff3966e9c
name : ref_grch38.fasta
project : RFranklin/folders-api-testing
parent : 5bd7c53ee4b04b8fb1a9f63c
type : file</code></pre>
<p>If <code>complete = FALSE</code> (default), it will only return the (first) page from the API based on <code>offset</code> and <code>limit</code>.</p>
<p>To list only files or only folders, set <code>type = "file"</code> or <code>type = "folder"</code>:</p>
<div class="sourceCode" id="cb151"><html><body><pre class="r"><span class="no">root_folder</span>$<span class="fu">list_folder_contents</span>(<span class="kw">type</span> <span class="kw">=</span> <span class="st">"file"</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">root_folder</span>$<span class="fu">list_folder_contents</span>(<span class="kw">type</span> <span class="kw">=</span> <span class="st">"folder"</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-file-and-folder-details" class="section level3">
<h3 class="hasAnchor">
<a href="#get-file-and-folder-details" class="anchor"></a>Get file and folder details</h3>
<p>Get the type of a single file/folder object:</p>
<div class="sourceCode" id="cb152"><html><body><pre class="r"><span class="no">contents_root</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span>()</pre></body></html></div>
<pre><code>[1] "folder"</code></pre>
<p>Or, get the type(s) for all objects in the folder:</p>
<div class="sourceCode" id="cb154"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">contents_root</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>$<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span>())</pre></body></html></div>
<pre><code>[1] "folder" "file"</code></pre>
<p>Sometimes, it’s convenient to get the parent folder ID for a file or folder:</p>
<div class="sourceCode" id="cb156"><html><body><pre class="r"><span class="no">contents_root</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="fu">get_parent_folder_id</span>()</pre></body></html></div>
<pre><code>[1] "5bd7c53ee4b04b8fb1a9f63c"</code></pre>
<p>This is essentially the root folder ID. Alternatively, to get the parent folder as an object, use</p>
<div class="sourceCode" id="cb158"><html><body><pre class="r"><span class="no">contents_root</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="fu">get_parent_folder</span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-files-in-a-folder" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-files-in-a-folder" class="anchor"></a>Delete files in a folder</h3>
<p>We can delete a file in a folder:</p>
<div class="sourceCode" id="cb159"><html><body><pre class="r"><span class="no">file1</span>$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-a-folder" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-a-folder" class="anchor"></a>Delete a folder</h3>
<p>If a folder still has files in it, it cannot be deleted:</p>
<div class="sourceCode" id="cb160"><html><body><pre class="r"><span class="no">file2</span> <span class="kw">&lt;-</span> <span class="no">file2</span>$<span class="fu">move_to_folder</span>(<span class="no">folder2</span>$<span class="no">id</span>)
<span class="no">folder2</span>$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()</pre></body></html></div>
<pre><code>Error: HTTP Status 400: Deleting non-empty folders is not supported.</code></pre>
<p>We need to delete all files (and subfolders) within a folder before deleting the folder itself:</p>
<div class="sourceCode" id="cb162"><html><body><pre class="r"><span class="no">file2</span>$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()
<span class="no">folder2</span>$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()
<span class="no">folder1</span>$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="apps" class="section level2">
<h2 class="hasAnchor">
<a href="#apps" class="anchor"></a>Apps</h2>
<p>All Seven Bridges environments support the <a href="http://www.commonwl.org/">Common Workflow Language (CWL)</a> natively to allow for reproducible and portable workflows and tools. In this section, we will work with apps, including tools and workflows, via the API using the <code>sevenbridges</code> R package.</p>
<div align="right">
<a href="#top">top</a>
</div>
<div id="list-all-apps" class="section level3">
<h3 class="hasAnchor">
<a href="#list-all-apps" class="anchor"></a>List all apps</h3>
<p>This call lists all the apps available to you.</p>
<div class="sourceCode" id="cb163"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">app</span>()
<span class="co"># or show details</span>
<span class="no">a</span>$<span class="fu">app</span>(<span class="kw">detail</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><strong>Search for an app by name</strong></p>
<p>To search for a specific app by its name, pass a pattern for the <code>name</code> argument or provide a unique <code>id</code> as shown below.</p>
<div class="sourceCode" id="cb164"><html><body><pre class="r"><span class="co"># pattern match</span>
<span class="no">a</span>$<span class="fu">app</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"STAR"</span>)
<span class="co"># unique id</span>
<span class="no">aid</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">app</span>()<span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">id</span>
<span class="no">aid</span>
<span class="no">a</span>$<span class="fu">app</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">aid</span>)
<span class="co"># get a specific revision from an app</span>
<span class="no">a</span>$<span class="fu">app</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">aid</span>, <span class="kw">revision</span> <span class="kw">=</span> <span class="fl">0</span>)</pre></body></html></div>
<p><strong>List all apps in a project</strong></p>
<p>To list all apps belonging to a specific project, use the <code>project</code> argument.</p>
<div class="sourceCode" id="cb165"><html><body><pre class="r"><span class="co"># my favorite, always</span>
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu">app</span>()

<span class="co"># or alternatviely</span>
<span class="no">pid</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="no">id</span>
<span class="no">a</span>$<span class="fu">app</span>(<span class="kw">project</span> <span class="kw">=</span> <span class="no">pid</span>)</pre></body></html></div>
<p><strong>List all public apps</strong></p>
<p>To list all public apps, use the <code>visibility</code> argument.</p>
<div class="sourceCode" id="cb166"><html><body><pre class="r"><span class="co"># show 100 items from public</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">app</span>(<span class="kw">visibility</span> <span class="kw">=</span> <span class="st">"public"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>)
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">app</span>(<span class="kw">visibility</span> <span class="kw">=</span> <span class="st">"public"</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>)
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">app</span>(<span class="kw">project</span> <span class="kw">=</span> <span class="st">"RFranklin/helloworld"</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>)
<span class="no">a</span>$<span class="fu">app</span>(<span class="kw">visibility</span> <span class="kw">=</span> <span class="st">"public"</span>, <span class="kw">limit</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">offset</span> <span class="kw">=</span> <span class="fl">150</span>)</pre></body></html></div>
<p><strong>Search through all public apps in all locations</strong></p>
<p>To search for a public app cross all locations, make the following call. Note that this may take a bit of time.</p>
<div class="sourceCode" id="cb167"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">app</span>(<span class="st">"STAR"</span>, <span class="kw">visibility</span> <span class="kw">=</span> <span class="st">"public"</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="copy-an-app" class="section level3">
<h3 class="hasAnchor">
<a href="#copy-an-app" class="anchor"></a>Copy an app</h3>
<p>This call copies the specified app to a specified project. The app should be one in a project that you can access, either an app which has been uploaded by a project member or a publicly available app which has been copied to the project.</p>
<p>This call requires the following two arguments:</p>
<ul>
<li>
<code>project</code>: include the project id</li>
<li>
<code>name</code> (optional): use this field to optionally re-name your app</li>
</ul>
<div class="sourceCode" id="cb168"><html><body><pre class="r"><span class="no">aid</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">public_app</span>()<span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">id</span>
<span class="no">a</span>$<span class="fu">copy_app</span>(<span class="no">aid</span>, <span class="kw">project</span> <span class="kw">=</span> <span class="no">pid</span>, <span class="kw">name</span> <span class="kw">=</span> <span class="st">"copy-rename-test"</span>)
<span class="co"># check if it is copied</span>
<span class="no">a</span>$<span class="fu">app</span>(<span class="kw">project</span> <span class="kw">=</span> <span class="no">pid</span>)</pre></body></html></div>
<p>You can also copy directly from the app object, as shown below.</p>
<div class="sourceCode" id="cb169"><html><body><pre class="r"><span class="no">app</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">public_app</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"admin/sbg-public-data/rna-seq-alignment-star"</span>)
<span class="no">app</span>$<span class="fu">copy_to</span>(
  <span class="kw">project</span> <span class="kw">=</span> <span class="st">"RFranklin/api-testing"</span>,
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"copy of star"</span>
)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-an-apps-cwl-description" class="section level3">
<h3 class="hasAnchor">
<a href="#get-an-apps-cwl-description" class="anchor"></a>Get an app’s CWL description</h3>
<p>This call returns the raw CWL of a specific app, including its raw CWL. The call differs from the call to GET details of an app in that it returns a JSON object that is the CWL.</p>
<p>The app should be one in a project that you can access, either an app which has been uploaded by a project member or a publicly available app which has been copied to the project.</p>
<p>To get a specific revision, pass the <code>revision</code> argument.</p>
<div class="sourceCode" id="cb170"><html><body><pre class="r"><span class="no">ap</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">app</span>(<span class="kw">visibility</span> <span class="kw">=</span> <span class="st">"public"</span>)<span class="kw">[[</span><span class="fl">1</span>]]
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu">app</span>(<span class="st">"index"</span>)
<span class="co"># get a specific revision</span>
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu">app</span>(<span class="st">"index"</span>, <span class="kw">revision</span> <span class="kw">=</span> <span class="fl">0</span>)</pre></body></html></div>
<p>Coming soon: converting apps to CWL objects</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="add-cwl-as-an-app" class="section level3">
<h3 class="hasAnchor">
<a href="#add-cwl-as-an-app" class="anchor"></a>Add CWL as an app</h3>
<p>To add a CWL object as an app, use the <code>app_add</code> function call for a <code>Project</code> object. The following two parameters are required:</p>
<ul>
<li>
<code>short_name</code>: Project short names are based on the name you give to a project when you create it. Learn more about project short names on the <a href="https://docs.sevenbridges.com/v1.0/docs/the-api#section-project-short-names">Seven Bridges Platform</a> or the <a href="http://docs.cancergenomicscloud.org/v1.0/docs/the-cgc-api#section-project-short-names">CGC</a>.</li>
<li>
<code>filename</code>: The name of the JSON file containing the CWL.</li>
</ul>
<div class="sourceCode" id="cb171"><html><body><pre class="r"><span class="no">cwl.fl</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"bam_index.json"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"sevenbridges"</span>)
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu">app_add</span>(<span class="kw">short_name</span> <span class="kw">=</span> <span class="st">"new_bam_index_app"</span>, <span class="kw">filename</span> <span class="kw">=</span> <span class="no">cwl.fl</span>)
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu">app_add</span>(<span class="kw">short_name</span> <span class="kw">=</span> <span class="st">"new_bam_index_app"</span>, <span class="kw">revision</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">filename</span> <span class="kw">=</span> <span class="no">cwl.fl</span>)</pre></body></html></div>
<p>Note: If you provide the same <code>short_name</code>, this will add a new revision.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="describe-cwl-in-r-directly" class="section level3">
<h3 class="hasAnchor">
<a href="#describe-cwl-in-r-directly" class="anchor"></a>Describe CWL in R directly</h3>
<p>This is introduced in another vignette (<code><a href="../articles/apps.html">vignette("apps", "sevenbridges")</a></code>).</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-test-or-keep-the-previous-test-for-tool" class="section level3">
<h3 class="hasAnchor">
<a href="#create-test-or-keep-the-previous-test-for-tool" class="anchor"></a>Create test or keep the previous test for Tool</h3>
<p>On Seven Bridges platforms, when you create or update your tools in the GUI, there is a test tab allow users to tweak the parameters and see what it looks like in your command line simulated terminal. To do this via R when you push your Tool object to your project, you need to provide <code>"sbg:job"</code> information like the example shown below</p>
<div class="sourceCode" id="cb172"><html><body><pre class="r"><span class="no">rbx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Tool-class.html">Tool</a></span>(
  <span class="kw">id</span> <span class="kw">=</span> <span class="st">"runif"</span>,
  <span class="kw">label</span> <span class="kw">=</span> <span class="st">"Random number generator"</span>,
  <span class="kw">hints</span> <span class="kw">=</span> <span class="fu"><a href="../reference/requirements.html">requirements</a></span>(
    <span class="fu"><a href="../reference/requirements.html">docker</a></span>(<span class="kw">pull</span> <span class="kw">=</span> <span class="st">"RFranklin/runif"</span>),
    <span class="fu"><a href="../reference/requirements.html">cpu</a></span>(<span class="fl">1</span>), <span class="fu"><a href="../reference/requirements.html">mem</a></span>(<span class="fl">2000</span>)
  ),
  <span class="kw">baseCommand</span> <span class="kw">=</span> <span class="st">"runif.R"</span>,
  <span class="kw">inputs</span> <span class="kw">=</span> <span class="no">in.lst</span>,
  <span class="kw">outputs</span> <span class="kw">=</span> <span class="no">out.lst</span>,
  <span class="st">"sbg:job"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">allocatedResources</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">mem</span> <span class="kw">=</span> <span class="fl">9000</span>, <span class="kw">cpu</span> <span class="kw">=</span> <span class="fl">1</span>),
    <span class="kw">inputs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">min</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">max</span> <span class="kw">=</span> <span class="fl">150</span>)
  )
)
<span class="no">p</span>$<span class="fu">app_add</span>(<span class="st">"random"</span>, <span class="no">rbx</span>)</pre></body></html></div>
<p>Or if you have created test info on the platform or previously pushed one, and you want to keep the previous test setup. We provide an argument named <code>keep_test</code> to allow you to keep the previous revision’s test information.</p>
<div class="sourceCode" id="cb173"><html><body><pre class="r"><span class="no">rbx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Tool-class.html">Tool</a></span>(
  <span class="kw">id</span> <span class="kw">=</span> <span class="st">"runif"</span>,
  <span class="kw">label</span> <span class="kw">=</span> <span class="st">"Random number generator"</span>,
  <span class="kw">hints</span> <span class="kw">=</span> <span class="fu"><a href="../reference/requirements.html">requirements</a></span>(
    <span class="fu"><a href="../reference/requirements.html">docker</a></span>(<span class="kw">pull</span> <span class="kw">=</span> <span class="st">"RFranklin/runif"</span>),
    <span class="fu"><a href="../reference/requirements.html">cpu</a></span>(<span class="fl">1</span>), <span class="fu"><a href="../reference/requirements.html">mem</a></span>(<span class="fl">2000</span>)
  ),
  <span class="kw">baseCommand</span> <span class="kw">=</span> <span class="st">"runif.R"</span>,
  <span class="kw">inputs</span> <span class="kw">=</span> <span class="no">in.lst</span>,
  <span class="kw">outputs</span> <span class="kw">=</span> <span class="no">out.lst</span>
)
<span class="no">p</span>$<span class="fu">app_add</span>(<span class="st">"random"</span>, <span class="no">rbx</span>, <span class="kw">keep_test</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="tasks" class="section level2">
<h2 class="hasAnchor">
<a href="#tasks" class="anchor"></a>Tasks</h2>
<div id="list-tasks" class="section level3">
<h3 class="hasAnchor">
<a href="#list-tasks" class="anchor"></a>List tasks</h3>
<p>This call returns a list of tasks that you can access. You can filter tasks by status.</p>
<div class="sourceCode" id="cb174"><html><body><pre class="r"><span class="co"># all tasks</span>
<span class="no">a</span>$<span class="fu">task</span>()
<span class="co"># filter</span>
<span class="no">a</span>$<span class="fu">task</span>(<span class="kw">status</span> <span class="kw">=</span> <span class="st">"completed"</span>)
<span class="no">a</span>$<span class="fu">task</span>(<span class="kw">status</span> <span class="kw">=</span> <span class="st">"running"</span>)</pre></body></html></div>
<p>To list all the tasks in a project, use the following.</p>
<div class="sourceCode" id="cb175"><html><body><pre class="r"><span class="co"># a better way</span>
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu">task</span>()

<span class="co"># alternatively</span>
<span class="no">pid</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="no">id</span>
<span class="no">a</span>$<span class="fu">task</span>(<span class="kw">project</span> <span class="kw">=</span> <span class="no">pid</span>)</pre></body></html></div>
<p>To list all tasks with details, pass <code>detail = TRUE</code>.</p>
<div class="sourceCode" id="cb176"><html><body><pre class="r"><span class="no">p</span>$<span class="fu">task</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"your task id here"</span>, <span class="kw">detail</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">p</span>$<span class="fu">task</span>(<span class="kw">detail</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>To list a batch task using the <code>parent</code> parameter, pass the batch parent task id.</p>
<div class="sourceCode" id="cb177"><html><body><pre class="r"><span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/demo"</span>)
<span class="no">p</span>$<span class="fu">task</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"2e1ebed1-c53e-4373-870d-4732acacbbbb"</span>)
<span class="no">p</span>$<span class="fu">task</span>(<span class="kw">parent</span> <span class="kw">=</span> <span class="st">"2e1ebed1-c53e-4373-870d-4732acacbbbb"</span>)
<span class="no">p</span>$<span class="fu">task</span>(<span class="kw">parent</span> <span class="kw">=</span> <span class="st">"2e1ebed1-c53e-4373-870d-4732acacbbbb"</span>, <span class="kw">status</span> <span class="kw">=</span> <span class="st">"completed"</span>)
<span class="no">p</span>$<span class="fu">task</span>(<span class="kw">parent</span> <span class="kw">=</span> <span class="st">"2e1ebed1-c53e-4373-870d-4732acacbbbb"</span>, <span class="kw">status</span> <span class="kw">=</span> <span class="st">"draft"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-draft-task" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-draft-task" class="anchor"></a>Create a draft task</h3>
<p>To create a draft task, you need to call the <code>task_add</code> function from the Project object. And you need to pass the following arguments:</p>
<ul>
<li>
<code>name</code>: The name for this task</li>
<li>
<code>description</code> (optional): A description for this task</li>
<li>
<code>app</code>: The app id</li>
<li>
<code>inputs</code>: A list of inputs for this task</li>
</ul>
<div class="sourceCode" id="cb178"><html><body><pre class="r"><span class="co"># push an app first</span>
<span class="no">fl.runif</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"runif.json"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"sevenbridges"</span>)
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu">app_add</span>(<span class="st">"runif_draft"</span>, <span class="no">fl.runif</span>)
<span class="no">runif_id</span> <span class="kw">&lt;-</span> <span class="st">"RFranklin/demo-project/runif_draft"</span>
<span class="co"># create a draft task</span>
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu">task_add</span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Draft runif 3"</span>,
  <span class="kw">description</span> <span class="kw">=</span> <span class="st">"Description for runif 3"</span>,
  <span class="kw">app</span> <span class="kw">=</span> <span class="no">runif_id</span>,
  <span class="kw">inputs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">min</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">max</span> <span class="kw">=</span> <span class="fl">10</span>)
)
<span class="co"># confirm</span>
<span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu">task</span>(<span class="kw">status</span> <span class="kw">=</span> <span class="st">"draft"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="modify-a-task" class="section level3">
<h3 class="hasAnchor">
<a href="#modify-a-task" class="anchor"></a>Modify a task</h3>
<p>Call the <code>update</code> function from a Task object to update the following:</p>
<ul>
<li><code>name</code></li>
<li><code>description</code></li>
<li>
<code>inputs</code> list. Note that you can only update the items you provided.</li>
</ul>
<div class="sourceCode" id="cb179"><html><body><pre class="r"><span class="co"># get the single task you want to update</span>
<span class="no">tsk</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="st">"demo"</span>)$<span class="fu">task</span>(<span class="st">"Draft runif 3"</span>)
<span class="no">tsk</span>
<span class="no">tsk</span>$<span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Draft runif update"</span>,
  <span class="kw">description</span> <span class="kw">=</span> <span class="st">"draft 2"</span>,
  <span class="kw">inputs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">max</span> <span class="kw">=</span> <span class="fl">100</span>)
)
<span class="co"># alternative way to check all inputs</span>
<span class="no">tsk</span>$<span class="fu">getInputs</span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="run-a-task-1" class="section level3">
<h3 class="hasAnchor">
<a href="#run-a-task-1" class="anchor"></a>Run a task</h3>
<p>This call runs (“executes”) the specified task. Only tasks with a “DRAFT” status may be run.</p>
<div class="sourceCode" id="cb180"><html><body><pre class="r"><span class="no">tsk</span>$<span class="fu">run</span>()
<span class="co"># run update without information just return latest information</span>
<span class="no">tsk</span>$<span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
<p><a name="hook"></a> ### Monitor a running task and set the hook function</p>
<p>To monitor a running task, call <code>monitor</code> from a Task object.</p>
<ul>
<li>The first argument sets the interval time to check the status</li>
<li>Rest of the arguments might be used for the hook function</li>
</ul>
<div class="sourceCode" id="cb181"><html><body><pre class="r"><span class="no">tsk</span>$<span class="fu">monitor</span>()</pre></body></html></div>
<p>Get and set default a hook function for task status. Currently, failed tasks will break the monitoring.</p>
<p>Note: Hook function has to return <code>TRUE</code> (break monitoring) or <code>FALSE</code> (continuing) in the end.</p>
<div class="sourceCode" id="cb182"><html><body><pre class="r"><span class="fu"><a href="../reference/TaskHook.html">getTaskHook</a></span>(<span class="st">"completed"</span>)
<span class="fu"><a href="../reference/TaskHook.html">getTaskHook</a></span>(<span class="st">"draft"</span>)
<span class="fu"><a href="../reference/TaskHook.html">setTaskHook</a></span>(<span class="st">"draft"</span>, <span class="kw">function</span>() {
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"never happens"</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fl">TRUE</span>)
})
<span class="fu"><a href="../reference/TaskHook.html">getTaskHook</a></span>(<span class="st">"draft"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="abort-a-running-task" class="section level3">
<h3 class="hasAnchor">
<a href="#abort-a-running-task" class="anchor"></a>Abort a running task</h3>
<p>This call aborts the specified task. Only tasks whose status is “RUNNING” may be aborted.</p>
<div class="sourceCode" id="cb183"><html><body><pre class="r"><span class="co"># abort</span>
<span class="no">tsk</span>$<span class="fu">abort</span>()
<span class="co"># check</span>
<span class="no">tsk</span>$<span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-a-task" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-a-task" class="anchor"></a>Delete a task</h3>
<p>Note that you can only delete DRAFT tasks, not running tasks.</p>
<div class="sourceCode" id="cb184"><html><body><pre class="r"><span class="no">tsklst</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">task</span>(<span class="kw">status</span> <span class="kw">=</span> <span class="st">"draft"</span>)
<span class="co"># delete a single task</span>
<span class="no">tsklst</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()
<span class="co"># confirm</span>
<span class="no">a</span>$<span class="fu">task</span>(<span class="kw">status</span> <span class="kw">=</span> <span class="st">"draft"</span>)
<span class="co"># delete a list of tasks</span>
<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>(<span class="no">tsklst</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="download-all-files-from-a-completed-task" class="section level3">
<h3 class="hasAnchor">
<a href="#download-all-files-from-a-completed-task" class="anchor"></a>Download all files from a completed task</h3>
<div class="sourceCode" id="cb185"><html><body><pre class="r"><span class="no">tsk</span>$<span class="fu"><a href="../reference/download-methods.html">download</a></span>(<span class="st">"~/Downloads"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="run-tasks-in-batch-mode" class="section level3">
<h3 class="hasAnchor">
<a href="#run-tasks-in-batch-mode" class="anchor"></a>Run tasks in batch mode</h3>
<p>To run tasks in batch mode, (check <code><a href="../reference/batch.html">?batch</a></code>) for more details. The code below is a mockup example.</p>
<div class="sourceCode" id="cb186"><html><body><pre class="r"><span class="co"># batch by items</span>
(<span class="no">tsk</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu">task_add</span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"RNA DE report new batch 2"</span>,
  <span class="kw">description</span> <span class="kw">=</span> <span class="st">"RNA DE analysis report"</span>,
  <span class="kw">app</span> <span class="kw">=</span> <span class="no">rna.app</span>$<span class="no">id</span>,
  <span class="kw">batch</span> <span class="kw">=</span> <span class="fu"><a href="../reference/batch.html">batch</a></span>(<span class="kw">input</span> <span class="kw">=</span> <span class="st">"bamfiles"</span>),
  <span class="kw">inputs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">bamfiles</span> <span class="kw">=</span> <span class="no">bamfiles.in</span>,
    <span class="kw">design</span> <span class="kw">=</span> <span class="no">design.in</span>,
    <span class="kw">gtffile</span> <span class="kw">=</span> <span class="no">gtf.in</span>
  )
))

<span class="co"># batch by metadata, input files has to have metadata fields specified</span>
(<span class="no">tsk</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu">task_add</span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"RNA DE report new batch 3"</span>,
  <span class="kw">description</span> <span class="kw">=</span> <span class="st">"RNA DE analysis report"</span>,
  <span class="kw">app</span> <span class="kw">=</span> <span class="no">rna.app</span>$<span class="no">id</span>,
  <span class="kw">batch</span> <span class="kw">=</span> <span class="fu"><a href="../reference/batch.html">batch</a></span>(
    <span class="kw">input</span> <span class="kw">=</span> <span class="st">"fastq"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"metadata.sample_id"</span>, <span class="st">"metadata.library_id"</span>)
  ),
  <span class="kw">inputs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">bamfiles</span> <span class="kw">=</span> <span class="no">bamfiles.in</span>,
    <span class="kw">design</span> <span class="kw">=</span> <span class="no">design.in</span>,
    <span class="kw">gtffile</span> <span class="kw">=</span> <span class="no">gtf.in</span>
  )
))</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="volumes" class="section level2">
<h2 class="hasAnchor">
<a href="#volumes" class="anchor"></a>Volumes</h2>
<p>Cloud storage providers come with their own interfaces, features, and terminology. At a certain level, though, they all view resources as data objects organized in repositories. Authentication and operations are commonly defined on those objects and repositories, and while each cloud provider might call these things different names and apply different parameters to them, their basic behavior is the same.</p>
<p>Seven Bridges environments mediate access to these repositories using volumes. A volume is associated with a particular cloud storage repository that you have enabled Seven Bridges to read from (and, optionally, to write to). Currently, volumes may be created using two types of cloud storage repository: Amazon Web Services’ (AWS) S3 buckets and Google Cloud Storage (GCS) buckets.</p>
<p>A volume enables you to treat the cloud repository associated with it as external storage. You can ‘import’ files from the volume to your Seven Bridges environment to use them as inputs for computation. Similarly, you can write files from the Seven Bridges environment to your cloud storage by ‘exporting’ them to your volume.</p>
<p>Learn more about volumes on the <a href="https://docs.sevenbridges.com/docs/connecting-cloud-storage-overview">Seven Bridges Platform</a> and the <a href="http://docs.cancergenomicscloud.org/docs/connect-cloud-storage-overview">CGC</a>.</p>
<div id="create-a-volume" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-volume" class="anchor"></a>Create a volume</h3>
<div class="sourceCode" id="cb187"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">user</span> <span class="kw">=</span> <span class="st">"RFranklin"</span>, <span class="kw">platform</span> <span class="kw">=</span> <span class="st">"aws-us"</span>)

<span class="no">a</span>$<span class="fu">add_volume</span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"tutorial_volume"</span>,
  <span class="kw">type</span> <span class="kw">=</span> <span class="st">"s3"</span>,
  <span class="kw">bucket</span> <span class="kw">=</span> <span class="st">"RFranklin-demo"</span>,
  <span class="kw">prefix</span> <span class="kw">=</span> <span class="st">""</span>,
  <span class="kw">access_key_id</span> <span class="kw">=</span> <span class="st">"your_access_key_id"</span>,
  <span class="kw">secret_access_key</span> <span class="kw">=</span> <span class="st">"your_secret_access_key"</span>,
  <span class="kw">sse_algorithm</span> <span class="kw">=</span> <span class="st">"AES256"</span>,
  <span class="kw">access_mode</span> <span class="kw">=</span> <span class="st">"RW"</span>
)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="list-and-search-all-volumes" class="section level3">
<h3 class="hasAnchor">
<a href="#list-and-search-all-volumes" class="anchor"></a>List and search all volumes</h3>
<div class="sourceCode" id="cb188"><html><body><pre class="r"><span class="co"># list all volume</span>
<span class="no">a</span>$<span class="fu">volume</span>()
<span class="co"># get unique volume by id</span>
<span class="no">a</span>$<span class="fu">volume</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/RFranklin_demo"</span>)
<span class="co"># partial search by name</span>
<span class="no">a</span>$<span class="fu">volume</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"demo"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-a-volumes-detail" class="section level3">
<h3 class="hasAnchor">
<a href="#get-a-volumes-detail" class="anchor"></a>Get a volume’s detail</h3>
<div class="sourceCode" id="cb189"><html><body><pre class="r"><span class="no">v</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">volume</span>()
<span class="no">v</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="fu">detail</span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-volume" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-volume" class="anchor"></a>Delete volume</h3>
<p>This call deletes a volume you’ve created to refer to storage on Amazon Web Services or Google Cloud Storage.</p>
<p>Note that any files you’ve imported from your volume onto a Seven Bridges environment, known as an alias, will no longer be usable. If a new volume is created with the same volume_id as the deleted volume, aliases will point to files on the newly created volume instead (if those exist).</p>
<div class="sourceCode" id="cb190"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">volume</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/RFranklin_demo"</span>)$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="import-file-from-volume-to-project" class="section level3">
<h3 class="hasAnchor">
<a href="#import-file-from-volume-to-project" class="anchor"></a>Import file from volume to project</h3>
<p>This call imports a file from volume to your project.</p>
<div class="sourceCode" id="cb191"><html><body><pre class="r"><span class="no">v</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">volume</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/tutorial_volume"</span>)
<span class="no">res</span> <span class="kw">&lt;-</span> <span class="no">v</span>$<span class="fu">import</span>(
  <span class="kw">location</span> <span class="kw">=</span> <span class="st">"A-RNA-File.bam.bai"</span>,
  <span class="kw">project</span> <span class="kw">=</span> <span class="st">"RFranklin/s3tutorial"</span>,
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"new.bam.bai"</span>,
  <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>
)

<span class="co"># get job status update</span>
<span class="co"># state will be "COMPLETED" when it's finished, otherwise "PENDING"</span>
<span class="no">v</span>$<span class="fu">get_import_job</span>(<span class="no">res</span>$<span class="no">id</span>)
<span class="no">v</span></pre></body></html></div>
</div>
<div id="export-file-from-project-to-volume" class="section level3">
<h3 class="hasAnchor">
<a href="#export-file-from-project-to-volume" class="anchor"></a>Export file from project to volume</h3>
<p><strong>Important</strong> :</p>
<ul>
<li>The file selected for export must not be a public file or an alias. Aliases are objects stored in your cloud storage bucket which have been made available on a Seven Bridges environment. The volume you are exporting to must be configured for read-write access. To do this, set the access_mode parameter to RW when creating or modifying a volume.</li>
<li>If this call is successful, the original project file will become an alias to the newly exported object on the volume. The source file will be deleted from the Seven Bridges environment and, if no more copies of this file exist, it will no longer count towards your total storage price on the Seven Bridges environment.</li>
</ul>
<p>When testing, please update your file in a project.</p>
<div class="sourceCode" id="cb192"><html><body><pre class="r"><span class="no">res</span> <span class="kw">&lt;-</span> <span class="no">v</span>$<span class="fu">export</span>(
  <span class="kw">file</span> <span class="kw">=</span> <span class="st">"579fb1c9e4b08370afe7903a"</span>,
  <span class="kw">volume</span> <span class="kw">=</span> <span class="st">"RFranklin/tutorial_volume"</span>,
  <span class="kw">location</span> <span class="kw">=</span> <span class="st">""</span>, <span class="co"># when "" use old name</span>
  <span class="kw">sse_algorithm</span> <span class="kw">=</span> <span class="st">"AES256"</span>
)
<span class="co"># get job status update</span>
<span class="co"># state will be "COMPLETED" when it's finished other wise "PENDING"</span>
<span class="no">v</span>$<span class="fu">get_export_job</span>(<span class="no">res</span>$<span class="no">id</span>)
<span class="no">v</span></pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="public-files-and-apps" class="section level2">
<h2 class="hasAnchor">
<a href="#public-files-and-apps" class="anchor"></a>Public Files and Apps</h2>
<p>Seven Bridges hosts publicly accessible files and apps on its environments. The <code>sevenbridges</code> package provides two easy function calls from the Authentication object to search for and copy files and apps to a project.</p>
<div id="public-files" class="section level3">
<h3 class="hasAnchor">
<a href="#public-files" class="anchor"></a>Public files</h3>
<div class="sourceCode" id="cb193"><html><body><pre class="r"><span class="co"># list the first 100 files</span>
<span class="no">a</span>$<span class="fu">public_file</span>()
<span class="co"># list by offset and limit</span>
<span class="no">a</span>$<span class="fu">public_file</span>(<span class="kw">offset</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">limit</span> <span class="kw">=</span> <span class="fl">100</span>)
<span class="co"># simply list everything!</span>
<span class="no">a</span>$<span class="fu">public_file</span>(<span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># get exact file by id</span>
<span class="no">a</span>$<span class="fu">public_file</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"5772b6f0507c175267448700"</span>)
<span class="co"># get exact file by name with exact = TRUE</span>
<span class="no">a</span>$<span class="fu">public_file</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"G20479.HCC1143.2.converted.pe_1_1Mreads.fastq"</span>, <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># with exact = FALSE by default search by name pattern</span>
<span class="no">a</span>$<span class="fu">public_file</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"fastq"</span>)
<span class="no">a</span>$<span class="fu">public_file</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"G20479.HCC1143.2.converted.pe_1_1Mreads.fastq"</span>)</pre></body></html></div>
<p>Public files are hosted in the project called <code>admin/sbg-public-data</code>, and you can alternatively use the <code>file</code> request to get files you need.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="public-apps" class="section level3">
<h3 class="hasAnchor">
<a href="#public-apps" class="anchor"></a>Public apps</h3>
<p>For public apps, there are similar API calls.</p>
<div class="sourceCode" id="cb194"><html><body><pre class="r"><span class="co"># list for 100 apps</span>
<span class="no">a</span>$<span class="fu">public_app</span>()
<span class="co"># list by offset and limit</span>
<span class="no">a</span>$<span class="fu">public_app</span>(<span class="kw">offset</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">limit</span> <span class="kw">=</span> <span class="fl">50</span>)
<span class="co"># search by id</span>
<span class="no">a</span>$<span class="fu">public_app</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"admin/sbg-public-data/control-freec-8-1/12"</span>)
<span class="co"># search by name in ALL apps</span>
<span class="no">a</span>$<span class="fu">public_app</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"STAR"</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># search by name with exact match</span>
<span class="no">a</span>$<span class="fu">public_app</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"Control-FREEC"</span>, <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="actions" class="section level2">
<h2 class="hasAnchor">
<a href="#actions" class="anchor"></a>Actions</h2>
<p>The Actions API allows you to copy files between projects in batch or send feedback to Seven Bridges.</p>
<div id="copy-files-between-projects" class="section level3">
<h3 class="hasAnchor">
<a href="#copy-files-between-projects" class="anchor"></a>Copy files between projects</h3>
<p>This call allows you to copy files between projects. Unlike <code>a$copyFile()</code> or <code>file(...)$copyTo(...)</code> which only copy one file with each API call, this call lets you batch the copy operation and copy a list of files at a time.</p>
<div class="sourceCode" id="cb195"><html><body><pre class="r"><span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/source-project"</span>)
<span class="no">f</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">complete</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># get all file IDs</span>
<span class="no">file_ids</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">f</span>, <span class="st">"[["</span>, <span class="st">"id"</span>)
<span class="co"># bulk copy files to the target project</span>
<span class="no">req</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">bulk_file_copy</span>(<span class="no">file_ids</span>, <span class="st">"RFranklin/target-project"</span>)
<span class="co"># print the response list</span>
(<span class="no">req</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span>(<span class="no">req</span>))</pre></body></html></div>
<pre><code>[[1]]
[[1]]$status
[1] "OK"

[[1]]$new_file_id
[1] "5bf31316e4b09b8ff39f9df7"

[[1]]$new_file_name
[1] "merged-tumor.converted.pe_1.fastq"

...</code></pre>
<p>We can use <code>sapply</code> to get the copy operation status, new file IDs, and (new) file names for the copied files:</p>
<div class="sourceCode" id="cb197"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">req</span>, <span class="st">"[["</span>, <span class="st">"status"</span>)</pre></body></html></div>
<pre><code>[1] "OK" "OK" "OK" "OK"</code></pre>
<div class="sourceCode" id="cb199"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">req</span>, <span class="st">"[["</span>, <span class="st">"new_file_id"</span>)</pre></body></html></div>
<pre><code>[1] "5bf31316e4b09b8ff39f9df7" "5bf31316e4b09b8ff39f9dfa" "5bf31316e4b09b8ff39f9df4" "5bf31316e4b09b8ff39f9df1"</code></pre>
<div class="sourceCode" id="cb201"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">req</span>, <span class="st">"[["</span>, <span class="st">"new_file_name"</span>)</pre></body></html></div>
<pre><code>[1] "merged-tumor.converted.pe_1.fastq"  "merged-tumor.converted.pe_2.fastq"  "merged-normal.converted.pe_2.fastq"
[4] "merged-normal.converted.pe_1.fastq"</code></pre>
<p>Note that a file’s ID is dependent on the project it is contained in. So, when you copy files from one project to another, their IDs will be different in the target project. The file names, however, do not change by copying, except where copying would yield non-unique file names in the target project.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="send-a-feedback-item" class="section level3">
<h3 class="hasAnchor">
<a href="#send-a-feedback-item" class="anchor"></a>Send a feedback item</h3>
<p>Use this call to send feedbacks to Seven Bridges via the API. There are three feedback types available: <code>"idea"</code>, <code>"thought"</code>, or <code>"problem"</code>. You can send one feedback item per minute.</p>
<div class="sourceCode" id="cb203"><html><body><pre class="r"><span class="no">a</span>$<span class="fu">send_feedback</span>(
  <span class="st">"This is a test for sending feedback via API. Please ignore this message."</span>,
  <span class="kw">type</span> <span class="kw">=</span> <span class="st">"thought"</span>
)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="enterprise" class="section level2">
<h2 class="hasAnchor">
<a href="#enterprise" class="anchor"></a>Enterprise</h2>
<p>The Enterprise API allows you to manage your Enterprise on the Seven Bridges Platform via dedicated API calls.</p>
<div id="api-token-for-the-division-context" class="section level3">
<h3 class="hasAnchor">
<a href="#api-token-for-the-division-context" class="anchor"></a>API token for the division context</h3>
<p>Note that the authentication token for the Enterprise API is a separate token generated under the context of your division, which is different from your non-division (personal) auth token. You may see the following error when using the non-division token to call the Enterprise API:</p>
<pre><code>Error: HTTP Status 400: Insufficient privileges to access this resource. Not a division user.</code></pre>
<p>If you see this error, first switch to the correct division context (use the dropdown menu in the upper left corner), then click the “Developer” tab, click “Auth token”, generate the token, and use this token for API authentication.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="list-all-divisions" class="section level3">
<h3 class="hasAnchor">
<a href="#list-all-divisions" class="anchor"></a>List all divisions</h3>
<p>To list all divisions you have access to, use</p>
<div class="sourceCode" id="cb205"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="no">...</span>)

<span class="no">a</span>$<span class="fu">division</span>()</pre></body></html></div>
<pre><code>[[1]]
== Division ==
  id : the-division
name : The Division
[[2]]
== Division ==
  id : another-division
name : Another Division</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-details-of-a-division" class="section level3">
<h3 class="hasAnchor">
<a href="#get-details-of-a-division" class="anchor"></a>Get details of a division</h3>
<p>To get the details (ID and name) of a division, for example, the first division listed above, use</p>
<div class="sourceCode" id="cb207"><html><body><pre class="r">(<span class="no">d</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">division</span>(<span class="st">"the-division"</span>))</pre></body></html></div>
<pre><code>== Division ==
  id : the-division
name : The Division</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-team" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-team" class="anchor"></a>Create a team</h3>
<p>Let’s create two new teams under this division:</p>
<div class="sourceCode" id="cb209"><html><body><pre class="r"><span class="no">team1</span> <span class="kw">&lt;-</span> <span class="no">d</span>$<span class="fu">create_team</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"New Team 1"</span>)
<span class="no">team2</span> <span class="kw">&lt;-</span> <span class="no">d</span>$<span class="fu">create_team</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"New Team 2"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-details-of-a-team" class="section level3">
<h3 class="hasAnchor">
<a href="#get-details-of-a-team" class="anchor"></a>Get details of a team</h3>
<p>To check the details (ID and name) of the first team we just created, use</p>
<div class="sourceCode" id="cb210"><html><body><pre class="r"><span class="no">d</span>$<span class="fu">team</span>(<span class="no">team1</span>$<span class="no">id</span>)</pre></body></html></div>
<pre><code>== Team ==
id : 39f6cb44-9e3c-40e7-8639-3c0f3c1e4892
name : New Team 1</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="add-a-team-member" class="section level3">
<h3 class="hasAnchor">
<a href="#add-a-team-member" class="anchor"></a>Add a team member</h3>
<p>We can add division members to the teams we created. For example, let’s add yourself (with the division username <code>the-division/your_username</code>) and another division member (with the division username <code>the-division/another_username</code>) to the first team. Also, let’s add yourself to the second team:</p>
<div class="sourceCode" id="cb212"><html><body><pre class="r"><span class="no">team1</span>$<span class="fu">add_member</span>(<span class="st">"the-division/your_username"</span>)
<span class="no">team1</span>$<span class="fu">add_member</span>(<span class="st">"the-division/another_username"</span>)

<span class="no">team2</span>$<span class="fu">add_member</span>(<span class="st">"the-division/your_username"</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="list-team-members" class="section level3">
<h3 class="hasAnchor">
<a href="#list-team-members" class="anchor"></a>List team members</h3>
<p>List all team members and their roles:</p>
<div class="sourceCode" id="cb213"><html><body><pre class="r">(<span class="no">m1</span> <span class="kw">&lt;-</span> <span class="no">team1</span>$<span class="fu">member</span>())
(<span class="no">m2</span> <span class="kw">&lt;-</span> <span class="no">team2</span>$<span class="fu">member</span>())</pre></body></html></div>
<pre><code>[[1]]
== Team Member ==
username : the-division/another_username
role : ADMIN
[[2]]
== Team Member ==
username : the-division/your_username
role : ADMIN</code></pre>
<pre><code>[[1]]
== Team Member ==
username : the-division/your_username
role : ADMIN</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="remove-a-team-member" class="section level3">
<h3 class="hasAnchor">
<a href="#remove-a-team-member" class="anchor"></a>Remove a team member</h3>
<p>Let’s remove a user from the first team:</p>
<div class="sourceCode" id="cb216"><html><body><pre class="r"><span class="no">team1</span>$<span class="fu">remove_member</span>(<span class="no">m1</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">username</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="rename-a-team" class="section level3">
<h3 class="hasAnchor">
<a href="#rename-a-team" class="anchor"></a>Rename a team</h3>
<p>To rename a team, use:</p>
<div class="sourceCode" id="cb217"><html><body><pre class="r"><span class="no">team1</span>$<span class="fu">rename</span>(<span class="st">"Another Team Name"</span>)</pre></body></html></div>
<pre><code>== Team ==
id : 39f6cb44-9e3c-40e7-8639-3c0f3c1e4892
name : Another Team Name</code></pre>
<p>After renaming, the team will still have the same ID, just with a different name.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="list-your-teams-in-the-division" class="section level3">
<h3 class="hasAnchor">
<a href="#list-your-teams-in-the-division" class="anchor"></a>List your teams in the division</h3>
<p>To list the teams that you are a member of in a division, use</p>
<div class="sourceCode" id="cb219"><html><body><pre class="r"><span class="no">d</span>$<span class="fu">team</span>()</pre></body></html></div>
<p>Note that there could be a one-minute delay in the backend here if you just added yourself to the teams seconds ago.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-a-team" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-a-team" class="anchor"></a>Delete a team</h3>
<p>To delete the teams we created, use</p>
<div class="sourceCode" id="cb220"><html><body><pre class="r"><span class="no">team1</span>$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()
<span class="no">team2</span>$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="markers" class="section level2">
<h2 class="hasAnchor">
<a href="#markers" class="anchor"></a>Markers</h2>
<p>The Markers API allows you to add, get, modify, and delete genetic markers on BAM files. These genetic markers can be then examined in the <a href="https://docs.sevenbridges.com/v1.0/docs/seven-bridges-genome-browser">Seven Bridges Genome Browser</a>.</p>
<p>As of November 2018, the Markers API is still an Advance Access feature. To use this API, set the <code>advance_access</code> option to <code>TRUE</code>:</p>
<div class="sourceCode" id="cb221"><html><body><pre class="r"><span class="no">opt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"sevenbridges"</span>)
<span class="no">opt</span>$<span class="no">advance_access</span> <span class="kw">&lt;-</span> <span class="fl">TRUE</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">sevenbridges</span> <span class="kw">=</span> <span class="no">opt</span>)</pre></body></html></div>
<div id="create-a-marker" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-marker" class="anchor"></a>Create a marker</h3>
<p>Let’s create a new marker on a BAM file first:</p>
<div class="sourceCode" id="cb222"><html><body><pre class="r"><span class="co"># locate the project</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"RFranklin/api-markers"</span>)
<span class="co"># search for files with `.bam` in their names</span>
<span class="no">f</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">".bam"</span>)
<span class="co"># use the first BAM file</span>
<span class="no">f</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">f</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">id</span>)

<span class="co"># create two markers</span>
<span class="no">m1</span> <span class="kw">&lt;-</span> <span class="no">f</span>$<span class="fu">create_marker</span>(<span class="st">"The First Marker"</span>, <span class="kw">start</span> <span class="kw">=</span> <span class="fl">21631232</span>, <span class="kw">end</span> <span class="kw">=</span> <span class="fl">21631232</span>)
<span class="no">m2</span> <span class="kw">&lt;-</span> <span class="no">f</span>$<span class="fu">create_marker</span>(<span class="st">"The Second Marker"</span>, <span class="kw">start</span> <span class="kw">=</span> <span class="fl">21631156</span>, <span class="kw">end</span> <span class="kw">=</span> <span class="fl">21631158</span>, <span class="kw">chromosome</span> <span class="kw">=</span> <span class="st">"chr7"</span>, <span class="kw">private</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p>The possible parameters for creating the marker include</p>
<ul>
<li>The marker’s name (<code>name</code>)</li>
<li>The marker’s position (<code>start</code> and <code>end</code>)</li>
<li>Chromosome number (<code>chromosome</code>)</li>
<li>Whether the marker is private or public (<code>private</code>).</li>
</ul>
<p>The marker’s name and its position are mandatory parameters, and the others are optional.</p>
</div>
<div id="list-markers-available-on-a-file" class="section level3">
<h3 class="hasAnchor">
<a href="#list-markers-available-on-a-file" class="anchor"></a>List markers available on a file</h3>
<p>To list all markers on a file, use:</p>
<div class="sourceCode" id="cb223"><html><body><pre class="r"><span class="no">f</span>$<span class="fu">marker</span>()</pre></body></html></div>
<pre><code>[[1]]
== Marker ==
id : 5bf478e5d38f185f0c23bc44
name : The First Marker
[[2]]
== Marker ==
id : 5bf478e6d38f185f0c23bc45
name : The Second Marker</code></pre>
</div>
<div id="get-details-for-a-marker" class="section level3">
<h3 class="hasAnchor">
<a href="#get-details-for-a-marker" class="anchor"></a>Get details for a marker</h3>
<p>We can also check the details for a specific marker:</p>
<div class="sourceCode" id="cb225"><html><body><pre class="r"><span class="no">marker_id</span> <span class="kw">&lt;-</span> <span class="no">m1</span>$<span class="no">id</span>
<span class="no">f</span>$<span class="fu">marker</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">marker_id</span>)</pre></body></html></div>
<pre><code>== Marker ==
id : 5bf478e5d38f185f0c23bc44
name : The First Marker
file : 5bf46c1be4b39b8f5232282e
position:
  start : 21631232
  end : 21631232
created_time : 2018-11-20T21:13:00Z
created_by : RFranklin
private : TRUE</code></pre>
</div>
<div id="modify-a-marker" class="section level3">
<h3 class="hasAnchor">
<a href="#modify-a-marker" class="anchor"></a>Modify a marker</h3>
<p>We can also modify the information of existing markers:</p>
<div class="sourceCode" id="cb227"><html><body><pre class="r">(<span class="no">m1</span> <span class="kw">&lt;-</span> <span class="no">m1</span>$<span class="fu">modify</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"New Marker Name"</span>, <span class="kw">end</span> <span class="kw">=</span> <span class="fl">21631233</span>, <span class="kw">private</span> <span class="kw">=</span> <span class="fl">FALSE</span>))</pre></body></html></div>
<pre><code>== Marker ==
id : 5bf478e5d38f185f0c23bc44
name : New Marker Name
file : 5bf46c1be4b39b8f5232282e
position:
  start : 21631232
  end : 21631233
created_time : 2018-11-20T21:13:00Z
created_by : RFranklin
private : FALSE</code></pre>
<p>All of the five marker parameters mentioned above can be modified.</p>
</div>
<div id="delete-a-marker" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-a-marker" class="anchor"></a>Delete a marker</h3>
<p>To delete the markers we just added, use</p>
<div class="sourceCode" id="cb229"><html><body><pre class="r"><span class="no">m1</span>$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()
<span class="no">m2</span>$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()</pre></body></html></div>
</div>
</div>
<div id="get-raw-response-from-httr" class="section level2">
<h2 class="hasAnchor">
<a href="#get-raw-response-from-httr" class="anchor"></a>Get Raw Response from httr</h2>
<p>In the easy API, we return an object which contains the raw response from <code>httr</code> as a field. You can either call <code><a href="../reference/response-methods.html">response()</a></code> on that object or use the field as is.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="batch-operation-on-projectfilestasks" class="section level2">
<h2 class="hasAnchor">
<a href="#batch-operation-on-projectfilestasks" class="anchor"></a>Batch Operation on Project/Files/Tasks</h2>
<p>Currently, users have to use <code>lapply</code> to do those operations themselves. It’s a simple implementation.</p>
<p>In this package, we implement <code>delete</code> and <code>download</code> for some objects like task, project, or file.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="api-cheatsheet" class="section level1">
<h1 class="hasAnchor">
<a href="#api-cheatsheet" class="anchor"></a>API Cheatsheet</h1>
<p>Quick API cheat sheet (work in progress):</p>
<div class="sourceCode" id="cb230"><html><body><pre class="r"><span class="co"># 01 - Authentication ----------------------------------------------------------</span>

<span class="fu">getToken</span>()

<span class="co"># authentication methods</span>
<span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">token</span> <span class="kw">=</span> <span class="no">token</span>)
<span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">token</span> <span class="kw">=</span> <span class="no">token</span>, <span class="kw">platform</span> <span class="kw">=</span> <span class="st">"cgc"</span>)
<span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="st">"env"</span>)
<span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="st">"file"</span>, <span class="kw">profile_name</span> <span class="kw">=</span> <span class="st">"aws-us-user"</span>)

<span class="co"># list all API calls</span>
<span class="no">a</span>$<span class="fu"><a href="../reference/api.html">api</a></span>()

<span class="co"># API rate limit</span>
<span class="no">a</span>$<span class="fu">rate_limit</span>()

<span class="co"># 02 - User -------------------------------------------------------------------</span>

<span class="no">a</span>$<span class="fu">user</span>()
<span class="no">a</span>$<span class="fu">user</span>(<span class="st">"RFranklin"</span>)

<span class="co"># 03 - Billing -----------------------------------------------------------------</span>

<span class="no">a</span>$<span class="fu">billing</span>()
<span class="no">a</span>$<span class="fu">billing</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">...</span>, <span class="kw">breakdown</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">a</span>$<span class="fu">invoice</span>()
<span class="no">a</span>$<span class="fu">invoice</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"your_id"</span>)

<span class="co"># 04 - Project -----------------------------------------------------------------</span>

<span class="co"># create new project</span>
<span class="no">a</span>$<span class="fu">project_new</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="no">...</span>, <span class="kw">billing_group_id</span> <span class="kw">=</span> <span class="no">...</span>, <span class="kw">description</span> <span class="kw">=</span> <span class="no">...</span>)

<span class="co"># list all project owned by you</span>
<span class="no">a</span>$<span class="fu">project</span>()
<span class="no">a</span>$<span class="fu">project</span>(<span class="kw">owner</span> <span class="kw">=</span> <span class="st">"Rosalind.Franklin"</span>)

<span class="co"># partial match</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">a</span>$<span class="fu">project</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="no">...</span>, <span class="kw">id</span> <span class="kw">=</span> <span class="no">...</span>, <span class="kw">exact</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># delete</span>
<span class="no">p</span>$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()

<span class="co"># update</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="no">...</span>, <span class="kw">description</span> <span class="kw">=</span> <span class="no">...</span>)

<span class="co"># members</span>
<span class="no">p</span>$<span class="fu">member</span>()
<span class="no">p</span>$<span class="fu">member_add</span>(<span class="kw">username</span> <span class="kw">=</span> <span class="no">...</span>)
<span class="no">p</span>$<span class="fu">member</span>(<span class="kw">username</span> <span class="kw">=</span> <span class="no">...</span>)$<span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(<span class="kw">write</span> <span class="kw">=</span> <span class="no">...</span>, <span class="kw">copy</span> <span class="kw">=</span> <span class="no">...</span>, <span class="kw">execute</span> <span class="kw">=</span> <span class="no">...</span>)
<span class="no">p</span>$<span class="fu">memeber</span>(<span class="kw">usrname</span> <span class="kw">=</span> <span class="no">...</span>)$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()

<span class="co"># 05 - File --------------------------------------------------------------------</span>

<span class="co"># list all files in this project</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>()

<span class="co"># list all public files</span>
<span class="no">a</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">visibility</span> <span class="kw">=</span> <span class="st">"public"</span>)

<span class="co"># copy</span>
<span class="no">a</span>$<span class="fu">copyFile</span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">fid</span>, <span class="no">fid2</span>), <span class="kw">project</span> <span class="kw">=</span> <span class="no">pid</span>)

<span class="co"># delete</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">fid</span>)$<span class="fu"><a href="../reference/delete-methods.html">delete</a></span>()

<span class="co"># download</span>
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>()<span class="kw">[[</span><span class="fl">1</span>]]$<span class="fu">download_url</span>()
<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">fid3</span>)$<span class="fu"><a href="../reference/download-methods.html">download</a></span>(<span class="st">"~/Downloads/"</span>)

<span class="co"># download all</span>
<span class="fu"><a href="../reference/download-methods.html">download</a></span>(<span class="no">p</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">file</a></span>())

<span class="co"># update a file</span>
<span class="no">fl</span>$<span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="no">...</span>, <span class="kw">metadata</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">a</span> <span class="kw">=</span> <span class="no">...</span>, <span class="kw">b</span> <span class="kw">=</span> <span class="no">...</span>, <span class="no">...</span>))

<span class="co"># metadata</span>
<span class="no">fl</span>$<span class="fu">meta</span>()
<span class="no">fl</span>$<span class="fu">setMeta</span>()
<span class="no">fl</span>$<span class="fu">setMeta</span>(<span class="no">...</span>, <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># 06 - App ---------------------------------------------------------------------</span>

<span class="no">a</span>$<span class="fu">app</span>()

<span class="co"># apps in a project</span>
<span class="no">p</span>$<span class="fu">app</span>()
<span class="no">p</span>$<span class="fu">app</span>(<span class="no">name</span>, <span class="no">id</span>, <span class="kw">revision</span> <span class="kw">=</span> <span class="no">...</span>)
<span class="no">a</span>$<span class="fu">copy_app</span>(<span class="no">aid</span>, <span class="kw">project</span> <span class="kw">=</span> <span class="no">pid</span>, <span class="kw">name</span> <span class="kw">=</span> <span class="no">...</span>)

<span class="co"># add new app</span>
<span class="no">p</span>$<span class="fu">app_add</span>(<span class="kw">short_name</span> <span class="kw">=</span> <span class="no">...</span>, <span class="kw">filename</span> <span class="kw">=</span> <span class="no">...</span>)

<span class="co"># 07 - Task --------------------------------------------------------------------</span>

<span class="no">a</span>$<span class="fu">task</span>()
<span class="no">a</span>$<span class="fu">task</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">...</span>)
<span class="no">a</span>$<span class="fu">task</span>(<span class="kw">status</span> <span class="kw">=</span> <span class="no">...</span>)

<span class="no">p</span>$<span class="fu">task</span>()
<span class="no">p</span>$<span class="fu">task</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">...</span>)
<span class="no">p</span>$<span class="fu">task</span>(<span class="kw">status</span> <span class="kw">=</span> <span class="no">...</span>)

<span class="no">tsk</span> <span class="kw">&lt;-</span> <span class="no">p</span>$<span class="fu">task</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">...</span>)
<span class="no">tsk</span>$<span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>()
<span class="no">tsk</span>$<span class="fu">abort</span>()
<span class="no">tsk</span>$<span class="fu">run</span>()
<span class="no">tsk</span>$<span class="fu"><a href="../reference/download-methods.html">download</a></span>()
<span class="no">tsk</span>$<span class="fu">detele</span>()
<span class="no">tsk</span>$<span class="fu">getInputs</span>()
<span class="no">tsk</span>$<span class="fu">monitor</span>()

<span class="fu"><a href="../reference/TaskHook.html">getTaskHook</a></span>()
<span class="fu"><a href="../reference/TaskHook.html">setTaskHook</a></span>(<span class="kw">status</span> <span class="kw">=</span> <span class="no">...</span>, <span class="kw">fun</span> <span class="kw">=</span> <span class="no">...</span>)</pre></body></html></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nan Xiao, Tengfei Yin, Seven Bridges Genomics.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
